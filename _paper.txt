1  Enhancing Fire Evacuation Safety in Underground Railway Stations: 1 Multi-Agent Reinforcement Learning-Guided Dynamic Signage 2 Coordination 3 Abstract:  4 Fire emergencies in multi-level underground railway stations present complex optimization challenges 5 characterized by high-density passenger flows, vertically coupled spaces, and rapidly evolving hazards. Traditional 6 Static Evacuation Signage (SES) often fails to adapt to the spatiotemporal dynamics of smoke propagation and crowd 7 congestion, leading to inefficient evacuation and increased safety risks. To address these limitations, this study 8 proposes an integrated simulationâ€“optimization framework for intelligent evacuation guidance. The framework 9 establishes a closed-loop coupling among three modules: (1) Physical Fire Modeling using PyroSim to generate high-10 fidelity hazard fields (e.g., toxic gas, heat) that dynamically degrade evacuee mobility; (2) Mesoscopic Crowd 11 Simulation (MCS) based on an enhanced cell transmission mechanism to capture capacity-constrained flow 12 dynamics in complex underground topologies; and (3) Multi-Agent Reinforcement Learning (MARL) utilizing the 13 QMIX algorithm to coordinate Dynamic Evacuation Signage (DES) agents distributed across multiple floors and 14 functional areas. Numerical experiments conducted across diverse fire scenarios in a real-world underground railway 15 station demonstrate that the proposed method significantly outperforms the static baseline in enhancing evacuation 16 efficiency and mitigating fire- and crowd-related risks, while exhibiting robust adaptability with the Transfer 17 Learning. Notably, in complex dual-fire scenarios, the approach achieves a reduction in total evacuation time of up 18 to 37.4%, while simultaneously lowering both cumulative fire risk and crowd safety risks by approximately 68%. 19 Overall, the proposed coupled simulationâ€“optimization framework demonstrates strong applicability and scalability 20 in resolving multi-objective problems under complex conditions, providing a scientific methodological basis for 21 enhancing the resilience and decision-making accuracy of railway transportation emergency management. 22 Keywords: Underground Railway Station, Fire safety, Evacuation guidance, Dynamic signage, Multi-agent 23 reinforcement learning 24 1. Introduction 25 As a critical component of modern railway transportation systems, urban rail transit networks are characterized 26 by high-density passenger flows and large-scale spatial complexity. While efficient, these enclosed environments are 27 inherently vulnerable to operational disruptions, particularly fire hazards (T. Lu et al., 2026). Even minor ignition 28 sources can rapidly escalate into cascading emergencies due to limited ventilation and smoke dispersion. The severity 29 of this threat has been underscored by recent high-profile incidents in 2025, including the Seoul subway arson attack 30 (The Chosun Daily, 2025), the Tokyo commuter line battery fire (SoraNews24, 2025), and the New York Upper 31 Manhattan subway fire (BNO News, 2025). Analysis of such events reveals that casualties primarily stem from 32 physiological incapacitation caused by toxic smoke and the collective disorder resulting from panic. These risks are 33 

2  exacerbated by prolonged evacuation times, highlighting the urgent need for adaptive and scientific management 34 decisions during crises (X. J. Li et al., 2023).  35 Current evacuation management typically combines on-site staff intervention with Static Evacuation Signage 36 (SES). While staff guidance is critical, it is often constrained by limited manpower relative to the massive passenger 37 throughput, making it difficult to achieve comprehensive coverage across multi-level stations during chaotic 38 emergencies (Padovano et al., 2024). Consequently, SES remains the primary directional reference for the majority 39 of evacuees in case of emergency. However, SES fails to respond to the spatiotemporal evolution of hazards and 40 often leads evacuees into congested or unsafe areas due to its inherent rigidity (Zhou et al., 2019). While Dynamic 41 Evacuation Signage (DES) systems offer a potential solution to bridge this gap, optimizing their control logic 42 constitutes a complex decision-making problem. Effective guidance requires balancing conflicting objectives, 43 including minimizing evacuation time, alleviating capacity constraints at bottlenecks, and reducing hazard exposure 44 (Ding et al., 2025; Guo & Zhang, 2022; Y. Zhang et al., 2025a). Traditional rule-based or heuristic methods often 45 struggle to provide optimal solutions in real-time due to the nonlinear interactions between fire dynamics and crowd 46 behavior. Independent decisions by individual signs can lead to bottleneck migration, necessitating a coordinated 47 approach capable of handling spatially coupled dynamics. 48 To address these challenges, this study proposes an integrated simulationâ€“optimization framework specifically 49 tailored for underground railway environments. Our approach establishes a closed-loop coupling among three 50 modules: (1) Physical Fire Modeling using PyroSim to generate high-fidelity hazard fields; (2) Mesoscopic Crowd 51 Simulation (MCS) based on an enhanced cell transmission mechanism to capture density-dependent flow dynamics; 52 and (3) Multi-Agent Reinforcement Learning (MARL) utilizing the QMIX algorithm. By treating DES units as 53 intelligent agents that learn from the coupled fireâ€“crowd environment, the system optimizes cooperative strategies 54 within a high-dimensional state space. This methodology effectively overcomes the limitations of static planning, 55 capturing the trade-offs between evacuation efficiency and safety. The contributions of this study are summarized as 56 follows:  57 â€¢ Integrating physical fire dynamics with MCS accounting for heterogeneous walking surfaces to efficiently and 58 accurately capture nonlinear hazardâ€“passenger interactions in complex underground railway environments. 59 â€¢ Introducing a coordinated multi-objective guidance mechanism based on the QMIX architecture, enabling 60 decentralized agents to simultaneously improve evacuation efficiency and mitigate multidimensional risks 61 arising from fire and crowd dynamics. 62 â€¢ Implementing a Transfer Learning mechanism to enhance computational efficiency in large-scale state spaces, 63 thereby demonstrating superior system adaptability across diverse fire scenarios in underground 64 railway infrastructure. 65 The remainder of this paper is organized as follows: Section 2 reviews related studies on fire evacuation in 66 underground railway environment, crowd and fire dynamics modelling and intelligent evacuation guidance. Section 67 3 details the proposed integrated simulationâ€“optimization framework. Section 4 presents the numerical tests in a 68 representative underground railway station environment under various fire scenarios, along with a detailed analysis 69 of the results. Section 5 summarizes the main contributions and conclusions of this study while outlining prospects 70 for future research. 71 

3  2. Literature Review 72 This section reviews the theoretical and methodological foundations relevant to fire evacuation in underground 73 railway stations. The review is structured into three dimensions: first, the specific hazard characteristics and risk 74 coupling mechanisms in underground railway station under fire; second, the simulation paradigms for modeling the 75 interaction between fire dynamics and crowd movement; and third, the evolution of evacuation guidance strategies 76 from static rules to adaptive reinforcement learning. 77 2.1  Fire Evacuation Challenges and Risk in Metro Stations 78 The complexity of underground railway station fires stems fundamentally from the diversity of ignition locations 79 and the resulting smoke propagation patterns. Research typically categorizes these incidents into platform, carriage, 80 and concourse fires, each presenting distinct threats to evacuation safety (N. Zhang et al., 2022). Platform and 81 carriage fires are particularly critical; smoke can spread rapidly through tunnels via the piston effect, trapping 82 passengers in confined subterranean spaces with limited egress options (D. Huang et al., 2019; X.â€‰Zhao et al., 2023). 83 Conversely, concourse fires often occur in commercial zones, leading to rapid smoke accumulation that obscures 84 primary exit routes (Tong et al., 2015). Regardless of the ignition source, the spatial interaction between spreading 85 heat, toxic smoke, and vertical passenger flow necessitates scenario-specific evacuation planning rather than generic 86 protocols (N. Zhang et al., 2022). 87 The consequences of underground railway station fires are multifaceted, extending beyond structural damage to 88 complex human and health risks. As Zhong et al. (2008) pointed out, injuries and fatalities in these scenarios are 89 predominantly caused by the hazardous environmental conditions generated by fire spread and by internal crowd 90 dynamics during evacuation rather than direct exposure to flames. Therefore, quantitative assessments of 91 underground railway station evacuation risk conducted by scholars incorporated multiple dimensions, including: (1) 92 Fire-induced hazard, determined by the combined effects of toxic gas concentrations, visibility degradation, and 93 temperatures exceeding safe thresholds in occupied areas (Bai et al., 2025; Cao et al., 2023; J. Xie et al., 2021); (2) 94 Crowd safety risk, evaluated by the occurrence of localized regions with excessively high crowd density during the 95 evacuation process (J. Chen et al., 2021; Hsu, 2024); and (3) Evacuation efficiency, typically measured by the total 96 evacuation time required for the last evacuee to reach a safe zone (B. Zhang et al., 2024a; L. Zhang et al., 2016); 97 These risk factors are inherently interrelated. Specifically, fire-induced hazards can cause physical impairment or 98 reduced mobility among evacuees, leading to local congestion and prolonged evacuation time (J. Xie et al., 2021). 99 Excessive crowding, in turn, not only increases the likelihood of falls and crush injuries but also further delays the 100 evacuation process (Chow & Ng, 2008). The extended evacuation duration consequently amplifies exposure to toxic 101 combustion products and heightens vulnerability to unstable crowd dynamics (Jin et al., 2020). Therefore, a 102 comprehensive station safety assessment should incorporate not only time-based performance indicators but also 103 multi-dimensional, cumulative risks that evolve over time through the dynamic interaction between fire conditions 104 and crowd movement (J. Chen et al., 2021). 105 Human behavior is a decisive factor in evacuation outcomes, yet it often transforms uncertainty into collective 106 disorder without effective guidance. Studies indicate that under stress, evacuees exhibit social influence effects (e. 107 g., herding and blind following) that exacerbate congestion and prolong exposure to hazards (Haghani & Sarvi, 2019; 108 

4  J. Lin et al., 2020). In the complex, multi-level topology of underground railway stations characterized by vertical 109 bottlenecks, these behavioral dynamics can rapidly propagate across interconnected spaces, destabilizing evacuation 110 flows (J. Chen et al., 2021; Guo & Zhang, 2022). Therefore, real-time adaptive guidance is critical for compensating 111 for impaired perception and mitigating crowd chaos, as demonstrated by B. Zhang et al. (2024b) in improving exit 112 utilization. 113 Despite these behavioral realities, current evacuation management remains limited in adaptability. Traditional 114 SES fails to respond to the spatiotemporal evolution of fire environments, potentially misleading evacuees into 115 smoke-filled or congested areas (H. Zhao et al., 2022). Furthermore, from a modeling perspective, most studies treat 116 fire propagation and crowd movement as decoupled processes, neglecting their mutual influence and the feedback 117 loop between environmental changes and decision-making (Bai et al., 2025). The lack of a dynamic feedback 118 mechanism connecting fire conditions, human decision-making, and guidance systems constrains the effectiveness 119 of current emergency response strategies (Ding et al., 2024). Consequently, a critical gap remains: the lack of an 120 integrated framework capable of jointly modeling hazard evolution, crowd dynamics, and adaptive guidance 121 optimization within complex underground spaces. Addressing this necessitates a unified simulationâ€“optimization 122 approach, which lays the foundation for the methodology proposed in this study. 123 2.2  Modeling Crowd Dynamics and Fire Propagation in Metro Evacuation 124 Modeling the coupled dynamics of fire propagation and human evacuation is a prerequisite for developing 125 effective safety strategies, particularly in confined underground environments. To accurately simulate human 126 movement under emergency conditions, researchers have developed various modeling approaches, generally 127 categorized into macroscopic, microscopic, and mesoscopic scales, each representing a distinct trade-off between 128 behavioral realism and computational efficiency. At the macroscopic level, crowd flow is typically described as a 129 continuous fluid governed by conservation laws of mass and momentum (Hughes, 2002; Twarogowska et al., 2014). 130 While these models allow for efficient analytical solutions in large-scale networks, they tend to homogenize 131 individual behaviors, often overlooking local decision-making processes (e.g., hesitation at decision points or 132 competition at staircases) that dominate evacuation outcomes in complex facilities. In contrast, microscopic 133 approaches simulate individuals as autonomous agents interacting through social and physical forces, as seen in the 134 Cellular Automata (Blue & Adler, 1998; Y. Zhang et al., 2022), Social Force Model (X. Chen et al., 2018; Helbing 135 & MolnÃ¡r, 1995) or Agent-based Models (Batty, 2001; Kasereka et al., 2025; S. Liu et al., 2014). These models excel 136 at reproducing complex behavioral phenomena like panic propagation, herding, and lane formation with high fidelity. 137 However, their computational burden increases exponentially with population size, creating a prohibitive bottleneck 138 for tasks that require massive iterative simulations, such as training Reinforcement Learning agents. 139 To bridge the gap between micro-level behavioral detail and macro-level computational scalability, mesoscopic 140 modeling frameworks have emerged as a balanced alternative. The MCS, originally developed for vehicular traffic, 141 has been successfully adapted for pedestrian dynamics (Asano et al., 2007). MCS discretizes the evacuation space 142 into a series of interconnected cells, each representing a small spatial unit characterized by density, inflow, and 143 outflow dynamics. The transitions between cells are governed by flow-capacity relations that account for congestion 144 effects, bottlenecks, and anisotropic movement patterns. Recent studies (N. Li & Guo, 2021; B. Zhang et al., 2024a) 145 have demonstrated that MCS is well suited for complex infrastructures such as underground railway stations, where 146 

5  spatial segmentation, bidirectional flows, and level transitions can be explicitly modeled. Moreover, the mesoscopic 147 resolution enables the model to be readily coupled with building environment factors, such as fire simulators, through 148 the exchange of time-varying environmental parameters (e.g., smoke density or temperature) that modify walking 149 speed and accessibility of cells (C. Z. T. Xie et al., 2025). These characteristics have led to the increasing application 150 of MCS in evacuation guidance planning. 151 Parallel to crowd modeling, the accurate representation of fire hazards is equally critical. The complexity of 152 underground railway stations, characterized by long tunnels, multi-level atriums, and piston effects, demands 153 sophisticated tools to resolve the spatial heterogeneity of smoke and heat spread (Wu et al., 2021; Y. Zhang et al., 154 2025). While simplified zone models (e.g., CFAST) (Peacock et al., 1993) provide computationally inexpensive 155 estimates by assuming uniform gas layers, they are often inadequate for capturing the stratified smoke layers and 156 local toxic concentrations unique to complex underground geometries. Consequently, Computational Fluid 157 Dynamics (CFD)-based approaches have become the cornerstone of modern fire safety analysis (Novozhilov, 2001). 158 The Fire Dynamics Simulator (FDS), and its enhanced graphical implementation PyroSim, solves the Navierâ€“Stokes 159 equations to predict fluid flow and heat transfer with high fidelity (Novozhilov, 2001). PyroSim has gained broad 160 adoption for its robustness in handling complex ventilation conditions and multi-zone connectivity (Ju, 2021; N. 161 Zhang et al., 2022), enabling the accurate reconstruction of the spatiotemporal evolution of visibility, temperature, 162 and CO concentration. 163 The integration of these physical and behavioral domains has led to the development of coupled simulation 164 frameworks, which move beyond treating fire as a static boundary condition. In these advanced frameworks, the 165 time-varying environmental data generated by CFD simulations are dynamically mapped onto the crowd model to 166 modulate pedestrian movement parameters (J. Wang et al., 2025). Deteriorating conditions, such as dense smoke or 167 high thermal radiation, directly degrade walking speeds and alter route availability, creating a realistic feedback loop 168 between hazard evolution and evacuation progress (S. Huang et al., 2024; L. Zhang et al., 2019). This closed-loop 169 coupling allows for a comprehensive assessment of cumulative risk and evacuation efficiency (D. W. Li et al., 2014; 170 Y. Lu et al., 2024), providing the necessary high-fidelity environment for the intelligent guidance optimization 171 proposed in this study. 172 2.3  DES and MARL in Evacuation Guidance 173 The development of DES systems has progressed from static algorithmic logic to adaptive, learning-based 174 control. Early implementations primarily relied on graph traversal algorithms, such as Dijkstraâ€™s algorithm or 175 Breadth-First Search, to identify shortest paths (Cho et al., 2015; Fu & Liu, 2020) or optimize exit assignment (Kang 176 et al., 2015) based on simplified linear evacuation time calculation. While computationally efficient, these graph-177 based methods often treat the evacuation network as a static topology, failing to account for rapidly evolving 178 congestion patterns or the stochastic spread of smoke. To incorporate crowd dynamics into decision-making, 179 subsequent research adopted heuristic optimization techniques, including Ant Colony Optimization (M. Li et al., 180 2022; Z. Liu & Zou, 2024) and bi-level programming frameworks (Guo et al., 2023; B. Zhang et al., 2024b). 181 Although these meta-heuristic approaches can generate near-optimal solutions by considering dynamic costs, their 182 iterative search mechanisms often incur significant computational latency, rendering them less suitable for sub-183 second real-time control in fire emergencies where conditions change instantaneously. 184 

6  Recent advances increasingly emphasize adaptive and data-driven approaches such as reinforcement learning 185 (RL), which directly learn decision policies through interaction with dynamic fireâ€“crowd environments (Sharma et 186 al., 2021). Recent applications have demonstrated the robust adaptability of RL in handling non-stationary 187 environments, evidenced by its success in complex autonomous driving tasks (Z. Huang et al., 2024; Sheng et al., 188 2024) and multi-objective intersection control (W. Lin et al., 2023). Similarly, within the underground railway station, 189 Shen et al. (2022) applied deep Q-learning (DQN) to develop an adaptive train-door control strategy for tunnel 190 evacuation. Their results demonstrated that learning-based door scheduling can significantly reduce congestion on 191 lateral evacuation platforms compared with fixed strategies, highlighting the ability of RL frameworks to optimize 192 evacuation-related infrastructure decisions under uncertainty. 193 Multi-agent reinforcement learning (MARL) further extends these capabilities by enabling distributed decision-194 making among multiple coordinated agents. Q. Wang et al. (2019) proposed an improved MARL framework 195 combining grouped leadership, shared experience buffers, and an enhanced social-force model to improve path 196 planning and convergence in crowd simulations. Fitkau & Hartmann (2025) applied MARL using proximal policy 197 optimization to jointly optimize path navigation and dynamic door adjustment, showing that navigator agents and 198 environmental-control agents can cooperatively reduce evacuation time without explicit communication. H. Zhao et 199 al. (2024) introduced an adversarial MARL framework for humanâ€“robot cooperative evacuation, demonstrating 200 improved robustness and higher survival rates in complex fire scenarios. These studies collectively confirm that 201 MARL is well suited for complex, multi-agent evacuation environments where decentralized agents must coordinate 202 decisions under dynamic hazards. 203 Despite these advancements, the application of MARL to underground railway station evacuation remains 204 constrained by significant modeling gaps. First, most existing studies simplify the environment into 2D grids, 205 neglecting the vertically coupled dynamics unique to underground railway stations, where congestion at staircases 206 creates nonlinear dependencies between platform and concourse flows. Second, environmental feedback in current 207 learning frameworks is often abstract, treating fire merely as static obstacles rather than evolving physical fields (e.g., 208 temperature, toxicity) that actively degrade pedestrian mobility. Consequently, there is a lack of integrated 209 frameworks that close the loop between high-fidelity fire simulation, mesoscopic crowd dynamics, and cooperative 210 learning. This study aims to bridge these gaps by proposing an integrated simulationâ€“optimization framework 211 specifically designed to optimize coordinated guidance in spatially complex, multi-level underground environments. 212 3. Methodology 213 To address the nonlinear interactions between evolving fire hazards and passenger movement in complex multi-214 level underground railway stations, this study proposes an integrated simulationâ€“optimization framework. As 215 illustrated in Fig. 1, the framework couples physical fire modeling, mesoscopic crowd simulation, and MARL into a 216 unified closed-loop system. The workflow proceeds through four coordinated modules:  217 First, the scenario definition (Fig. 1a) discretizes the high-fidelity BIM model of the underground railway station 218 into a mesoscopic network. This module establishes walkable paths, staircase bottlenecks, and the adjacency matrix 219 dependent on signage placement, forming the structural basis for simulation. 220 

7  Second, fire dynamics modeling (Fig. 1b) utilizes PyroSim to simulate the spatiotemporal evolution of smoke, 221 heat, and toxic gases. Unlike static hazard assumptions, this module quantifies CFD outputs into dynamic fire risk 222 indices and speed reduction coefficients, providing physically grounded boundary conditions for crowd movement. 223 Third, these hazard parameters dynamically modulate the MCS for evacuation simulation (Fig. 1c). Based on 224 an enhanced MCS with fire coupling, this module updates crowd density distributions by integrating capacity 225 constraints, density-dependent flow rules, and hazard-induced mobility degradation. 226 Finally, the MARL-based Control (Fig. 1d) treats DES as autonomous agents within the MCS environment. 227 Adopting the QMIX architecture to ensure global cooperation, agents perceive local crowd and hazard states to 228 generate adaptive directional guidance. The system operates in a closed loop: MARL-optimized actions reshape 229 passenger flows in the MCS, which in turn alters congestion patterns and hazard exposure, enabling scenario-230 responsive evacuation strategies that balance efficiency and safety. 231 
 232 Fig. 1. Architecture of the proposed integrated simulationâ€“optimization framework. (a) Scenario definition and 233 spatial discretization. (b) Fire dynamics simulation and impact quantification. (c) MCS for evacuation simulation 234 considering fire impact. (d) MARL-based cooperative optimization for DES. 235 3.1 Discrete Evacuation-Space Representation under DES Guidance 236 


8  Before integrating fire simulation, crowd dynamics, and MARL-based signage optimization, it is essential to 237 establish a unified spatial representation of the underground railway station that is aligned with the MCS which has 238 a decisive impact on the assessment of the evacuation process. The discrete evacuation-space representation includes 239 the MCS-oriented space discretization of the station, the selection of DES locations, the determination of signagesâ€™ 240 influence zones and the establishment of directional mapping rules that transfer signage decisions into MCS-241 consistent downstream cell relationships (as illustrated in Fig. 2).  242 
 243 Fig. 2. Workflow for discrete evacuation-space representation under DES guidance: (a) identification of walkable 244 regions and egress flow paths; (b) discretization of the environment into cells and selection of DES locations; (c) 245 assignment of discrete upstreamâ€“downstream cell relations according to the current signage directions. 246 The first step is to construct a unified spatial representation compatible with MCS for evacuation dynamics. The 247 station geometry is discretized into a grid of square cells with uniform side length ğ‘™, applied consistently to horizontal 248 circulation areas as well as vertical connectors such as stairways. For narrow stair segments whose physical width is 249 smaller than ğ‘™, the discretization preserves a cell length of ğ‘™ along the walking direction while adjusting lateral 250 connectivity to reflect the reduced capacity. Virtual cells with infinite capacity are placed beyond each exit to 251 represent the exterior safe region and remove evacuees from the computational domain once they reach safety. The 252 resulting set of discretized cells is denoted as ğ¶={c!,c",â€¦,câˆ£$âˆ£}, which constitutes the fundamental spatial units 253 for MCS. 254 Once the accessible space is discretized, DES units are introduced into the environment. Their initial placement 255 follows two principles. First, architectural drawings and station wayfinding plans are examined to identify critical 256 decision points (e. g., corridor intersections, turning points, platformâ€“stair interfaces, and concourseâ€“stair junctions) 257 where evacuees typically require directional guidance. Signage agents are placed at these topologically significant 258 nodes so that their decisions can effectively shape route selection across the station. Second, compliance with the 259 national standard GA 654-2006 (The Ministry of Public Security of the Peopleâ€™s Republic of China, 2006) is enforced, 260 which specifies that the separation distance between consecutive evacuation signs must not exceed 20 m. If any two 261 candidate signs violate this constraint, additional intermediate signage units are inserted at equal intervals along the 262 connecting corridor to satisfy regulatory spacing requirements and to ensure continuous visual guidance. 263 Next, the influence zone of each signage is defined. For each internal cell, the Euclidean distance from its 264 centroid to all signage agents is computed, and the cell is assigned to the nearest visible sign, where visibility is 265 determined by checking whether the line segment between the cell center and the sign is obstructed by solid geometry. 266 After the influence zones are established, a direction-mapping dictionary is created to translate signage actions into 267 


9  downstream cell choices used by the MCS. For any pair of adjacent cells c%,c&âˆˆğ¶ at the ğœ-th time step, a binary 268 indicator Ï€%&'âˆˆ{0,1} is defined, where Ï€%&'=1 indicates that c& serves as the downstream cell of c%, and Ï€%&'=269 0 otherwise. For each cell within an agentâ€™s influence zone, the downstream neighbor is selected based on a 270 potential-field-like rule inspired by static floor field methods in Cellular Automata-based evacuation models. 271 Specifically, among all neighboring cells, the one that produces the greatest reduction in the distance to the target 272 signage (or to the signage-indicated direction) is chosen as the preferred downstream cell. This dictionary enables 273 the MARL agentâ€™s high-level directional action (e.g., pointing left or indicating a particular corridor) to be reflected 274 in the MCS, thereby coupling signage decisions with passenger movement in a behaviorally coherent manner. 275 3.2 Effects of Fire Propagation on Crowd Movement and Safety Risk 276 To provide a stable and physically realistic representation of the fire environment required by the coupled 277 evacuation framework, PyroSim is employed as an offline fire-dynamics generator rather than a component that 278 participates in iterative simulation loops. Because its primary role is to supply time-resolved hazard fields 279 (determined by temperature, visibility, and toxic gas concentrations) that remain fixed during MARL training and 280 MCS, the emphasis is placed on physical accuracy rather than computational speed. Accordingly, a detailed three-281 dimensional model of the underground railway station was developed using BIM. The model, incorporating the 282 concourse, platform levels, staircases, escalators, and ventilation shafts, was then imported into PyroSim via the 283 Industry Foundation Classes (IFC) format. This geometric fidelity captures the vertical coupling of smoke transport 284 across levels. The computational domain is discretized using a structured mesh, with locally refined grids around 285 regions exhibiting sharp thermal or flow gradients (e. g., stair enclosures, platform edges, and tunnel portals) to 286 ensure numerical convergence. Material properties, thermal boundaries, and fire-resistant elements are assigned 287 according to station specifications so that the resulting hazard fields accurately reflect the physical tenability 288 conditions encountered during real underground fires. 289 To reflect the diversity of ignition possibilities in underground railway stations, three representative categories 290 of fire scenarios should be simulated: (1) Platform fires: These involve combustible materials on the platform, where 291 smoke spreads horizontally along the trackside while simultaneously rising toward the concourse. (2) Concourse 292 fires: Originating in upper-level commercial or equipment areas, these fires are characterized by rapid smoke filling 293 and significant visibility loss across open circulation zones due to high ventilation rates. (3) Metro carriage fires: 294 With ignition sources located inside the train, smoke is forced through carriage openings, rapidly accumulating on 295 the platform and spreading upwards to the concourse. All scenarios adopt a ğ‘¡"-growth model in the incipient stage, 296 followed by steady heat-release. 297 Fire byproducts that exceed permissible limits can substantially impair passenger movement efficiency by 298 reducing visibility and altering thermal comfort, which in turn slows evacuation progress. Beyond this impact on 299 mobility, prolonged exposure to elevated concentrations of smoke, heat, and toxic gases poses severe health risks, 300 making it essential to quantify both effects for accurate modeling and effective emergency management. Specifically, 301 for c% at the ğœ-th time step, PyroSim provides visibility ğ‘¦%,')%*=ğ‘¦%)%*(ğœâˆ™Î”ğ‘¡) (m), temperature ğ‘¦%,'+,-.=302 ğ‘¦%+,-.(ğœâˆ™Î”ğ‘¡) (Â°C), and CO concentration ğ‘¦%,'$/=ğ‘¦%$/(ğœâˆ™Î”ğ‘¡) (mol/mol) for the centroid of c% and the sampling 303 interval is aligned with the MCS step Î”t. It is determined by the cell length ğ‘™ and the free-flow speed ğ‘£01,,: 304 Î”ğ‘¡=ğ‘™/ğ‘£01,,.                             (1) 305 

10  Drawing upon empirical studies on human behavior in fire (Kim et al., 2024; Ye et al., 2020), we model the 306 effective velocity of passengers in c% at the ğœ-th time step as the free-flow speed ğ‘£01,, attenuated by a composite 307 reduction coefficient ğœ‘%'. This coefficient is the product of three independent factors:  308 ğœ‘!"=Î¦#!$$ğ‘¦!,"#!$&âˆ™Î¨ğ‘¡ğ‘’ğ‘šğ‘$ğ‘¦ğ‘–,ğœğ‘¡ğ‘’ğ‘šğ‘&âˆ™Î“ğ¶ğ‘‚$ğ‘¦ğ‘–,ğœğ¶ğ‘‚&.                    (2) 309 Each modifier is deliberately piecewise or smoothly bounded to prevent nonphysical outputs and to capture empirical 310 trends with modest model complexity. 311 (1) Visibility: The impact of visibility factor on evacueeâ€™s movement is evaluated with Î¦)%*9ğ‘¦%,')%*: which employs 312 two practical thresholds 7.5 meters and 2.5 meters to reflect the unimpeded movement and severely limited 313 mobility.  314 Î¦)%*9ğ‘¦%,')%*: â€Š= â€Šâ©â¨â§1ğ‘¦%,')%*â‰¥7.51.375 - â€Šâ€‰".9!":;!,#$!%2.5â‰¤ğ‘¦%,')%*<7.50.25ğ‘¦%,')%*<2.5	,                        (3) 315 (2) Temperature: The impact of temperature factor on evacueeâ€™s movement is evaluated with Î¨+,-.9ğ‘¦%,'+,-.: 316 which allows mild facilitation in warm but tolerable ranges (e.g., people move faster in slightly elevated 317 temperatures) and sharp attenuation beyond safety thresholds. Breakpoints 30â„ƒ, 60â„ƒ and 120â„ƒ can be 318 adopted from standards and then tuned to scenario specifics. 319 Î¨+,-.9ğ‘¦%,'+,-.:=â©âªâ¨âªâ§	1		ğ‘¦%,'+,-.â‰¤301+<)&'(=))*++>Ã—@A;!,#,+&-=BCD/BCF.)/30<ğ‘¦%,'+,-.â‰¤60)&'())*++K1âˆ’M9ğ‘¦%,'+,-.âˆ’30:/30N"O60<ğ‘¦%,'+,-.â‰¤120,     (4) 320 (3) Toxic gas: The impact of toxic gas factor on evacueeâ€™s movement is evaluated with Î“$/9ğ‘¦%,'$/: incorporates 321 CO concentration and exposure time. The function ensures accelerating penalty at higher concentrations, 322 capturing known dose-time effects. 0.1%	and 0.25% set regions for negligible, moderate, and critical toxicity. 323 Î“$/9ğ‘¦%,'$/:=R	1		ğ‘¦%,'$/â‰¤0.11âˆ’(0.2115+1.788âˆ™ğ‘¦%,'$/)âˆ™ğ‘¦%,'$/âˆ™Î”ğ‘¡0.1<ğ‘¦%,'$/â‰¤0.250ğ‘¦%,'$/>0.25,      (5) 324 Beyond affecting mobility, the DES must learn to steer crowds away from lethal zones. We define a comprehensive 325 risk index, â„œ%,'0%1,, to quantify the health threat in each cell. This index serves as a negative penalty in the MARL 326 reward function. The total risk is calculated as the arithmetic mean of four hazard components: the risk value of 327 visibility â„œ%,')%*, the risk value of temperature â„œ%,'+,-., the risk value of CO â„œ%,'$/, and the risk value of radiation â„›%,'GHI, 328 as following 329 â„œ%,'0%1,=!Jâˆ‘â„œ%,'KKâˆˆ{)%*,+,-.,$/,1NO}.                     (6) 330 

11  To standardize these disparate physical quantities into a normalized interval [0,1], we employ logistic sigmoid 331 functions as mentioned by Cao et al. (2023). This method smoothly maps the environmental values to a risk score 332 based on specific critical thresholds of the factors  Î·K,ğ‘›âˆˆ{ğ‘£ğ‘–ğ‘ ,ğ‘¡ğ‘’ğ‘šğ‘,ğ¶ğ‘‚,ğ‘Ÿğ‘ğ‘‘} and sensitivity factors ğ›½K,ğ‘›âˆˆ333 {ğ‘£ğ‘–ğ‘ ,ğ‘¡ğ‘’ğ‘šğ‘,ğ¶ğ‘‚,ğ‘Ÿğ‘ğ‘‘}. The unified formulation for the risk components can be expressed as 334 â„œ%',K=!!QRSTUV0â‹…<X0=;!,#0>Y,ğ‘›âˆˆ{ğ‘£ğ‘–ğ‘ ,ğ‘¡ğ‘’ğ‘šğ‘,ğ¶ğ‘‚,ğ‘Ÿğ‘ğ‘‘}.            (7) 335 Consistent with fire safety standards, Î·K,ğ‘›âˆˆ{ğ‘£ğ‘–ğ‘ ,ğ‘¡ğ‘’ğ‘šğ‘,ğ¶ğ‘‚,ğ‘Ÿğ‘ğ‘‘} are set to 2.5 kW/m"for radiation, 100âˆ˜C for 336 temperature, 0.28% for CO, and 5 m for visibility. The sensitivity factors adjust the steepness of the risk transition 337 near the threshold. 338 3.3 Enhanced Cell Transmission Mechanism Based MCS with Fire Coupling 339 The core principle of the MCS is to represent crowd movement through changes in pedestrian occupancy within 340 discretized cells of finite capacity, where pedestrian movement is governed by inflowâ€“outflow relationships between 341 adjacent cells. In the fire evacuation scenario examined in this study, the sending flow from each cell is jointly 342 influenced by three factors: (1) the movement direction dictated by DES, (2) the flow capacity determined by local 343 crowd density, and (3) the movement efficiency reduced by fire-induced environmental hazards. First, directional 344 movement is controlled through the upstreamâ€“downstream relationship indicator ğœ‹%&', introduced in Section 3.1, 345 which specifies whether cell c& is admissible as a downstream destination of cell c% at the ğœ-th time step. This 346 indicator varies not only across time steps within a single simulation, because DES directions change in real time, 347 but also across simulation episodes during MARL training, since DES decisions constitute the optimization variables 348 in the learning process. Second, density imposes two layers of constraints on pedestrian movement. At the capacity 349 level, the current density ğœŒ%' in cell ğ‘% determines the maximum number of evacuees that can depart during the 350 next time step. At the behavioral level, high-density conditions reduce walking efficiency through congestion effects, 351 thereby lowering the effective flow rate even when capacity is available. Third, as detailed in Section 3.2, the 352 accumulation of fire byproducts (i. e., temperature, smoke, and toxic gases) not only contributes to penalty terms in 353 the MARL reward function but also directly impedes evacuee movement. Rather than approximating hazard-affected 354 areas as static obstacles, the model employs a velocity reduction coefficient ğœ‘%' to dynamically adjust the cellâ€™s 355 outflow capacity in accordance with local hazard intensity. Integrating these factors, the potential flow (or sending 356 capacity) from c% to a downstream cell c& at the ğœ-th time step, denoted ğ‘„%&', represents the maximum number of 357 evacuees that can feasibly leave cell c%. For c% with area Î©% and current density ğœŒ%', the sending flow is computed 358 as: 359 ğ‘„%&'=Ï€%&'âˆ™min	{ğœŒ%'â‹…Î©%,ğ¹(ğœŒ%')â‹…ğ‘¤%&â‹…Î”ğ‘¡}âˆ™ğœ‘%',                (8) 360 where ğ‘¤%& is the width of the boundary between cells. And ğ¹(ğœŒ) is the flow-density relationship which is 361 corresponding to the fundamental diagram of pedestrian flow. Here, given the multi-level topology of subway 362 stations, the simulation must strictly distinguish between pedestrian kinematics on flat ground and staircases. Instead 363 of using generic parameters, we adopt the empirical standards provided in the SFPE Handbook of Fire Protection 364 Engineering (Hurley et al., 2016) to calibrate the fundamental diagram for different facility types. We define a 365 facility type indicator ğœ%âˆˆ{flat,stair} for each cell c%, representing its facility type (e.g., flat corridor, staircase with 366 specific geometry). Consistent with the SFPE guidelines, the critical density ğœŒ[1%+ (i. e., the threshold at which flow 367 

12  transitions from free to congested states) is assumed to be uniform across all facility types. However, in the congested 368 regime (ğœŒ[1%+<ğœŒâ‰¤ğœŒ&N-), the flow rate decreases linearly with density, where the rate of decay is governed by the 369 specific geometry of the facility. Consequently, the spatially differentiated flux function ğ¹(ğœŒ%') is formulated as: 370 ğ¹(ğœŒ%')=rğ‘£01,,,\!â‹…ğœŒ%'if 0â‰¤ğœŒ%'â‰¤ğœŒ[1%9ğ‘£01,,,\!âˆ’ğœ…\!â‹…ğœŒ%'	:â‹…ğœŒ%'if ğœŒ[1%<ğœŒ%'â‰¤ğœŒ-N].           (9) 371 Here, ğ‘£C,\! denotes the maximum specific flow capacity determined by the SFPE standards for facility type ğœ%. 372 While ğœŒ[1% and ğœŒ-N] kept identical across different cell types, the free flow velocity ğ‘£01,,,\! and the slope of the 373 congestion curve ğœ…\! vary, specifically penalizing movement on steeper staircases compared to flat ground. Notably 374 for staircases, this decay rate and the maximum specific flow are adjusted according to the riser-tread ratios, reflecting 375 the physical exertion required for vertical displacement. 376 However, the actual flow is also constrained by the receiving capacity of the downstream cell c&. In complex 377 evacuation scenarios involving merging flows (e.g., at corridor intersections), a single downstream cell c& may 378 receive inflows from multiple upstream cells. In such cases, the available receiving capacity must be rationed among 379 the incoming flows. Consequently, the actual flow ğ‘¦%&' transmitted from c% to c& is calculated by taking the 380 minimum of the sending supply and the proportionally allocated receiving capacity: 381 ğ‘¦%&'=mintğ‘„%&',u9ğœŒ-N]âˆ’ğœŒ&':â‹…Î©&+vğ‘¦&^'^âˆˆ_12wâ‹…`!1#a`31#3âˆˆ5!6x,         (10) 382 where Î“&Q denotes the set of all upstream cells feeding into cell c&. This mechanism ensures that congestion 383 propagates upstream realistically, preventing cell overflow. In this formulation, the term enclosed by square brackets 384 in the equation accounts for the simultaneous outflow from c& to its own downstream cells, effectively freeing up 385 space for inflows within the same time step. This calculation propagates from the exits (infinite capacity) backward 386 to the internal cells. 387 Consequently, the density of each cell c% after the ğœ-th time step can be updated according to the conservation 388 law: 389 ğœŒ%'Q!=ğœŒ%'âˆ’v;!3#b!^âˆˆ_!2+v;3!#b!^âˆˆ_!6.	                    (11) 390 To accurately resolve the inter-cell dependencies, specifically the constraint of downstream availability on 391 upstream flow, the computation at each time step follows a strict downstream-priority sequence. Before the 392 simulation commences, the network is mapped to establish a hierarchical calculation order based on the topological 393 relationship between upstream and downstream cells. At the beginning of each time step, the algorithm initiates the 394 flow calculation starting from the highest-priority internal cells (i.e., those directly connected to the exit nodes, where 395 the receiving capacity is unconstrained). The computation then recursively propagates inwards to cells with lower 396 priority (i.e., further upstream). This reverse-order traversal ensures that when an upstream cell calculates its outflow, 397 the remaining capacity of its downstream neighbor has already been determined, thereby strictly enforcing the 398 congestion transmission mechanism. Once the actual flow rates for all cell boundaries are computed for the current 399 

13  step, the crowd densities across the entire network are updated synchronously according to the conservation law in 400 Eq. (11). This iterative cycle, comprising the sequential flow calculation and synchronous density update, continues 401 until the crowd density in all internal cells decreases to zero, signifying the complete termination of the evacuation 402 process. 403 3.4 DES Guidance Optimization using MARL 404 To achieve adaptive coordination of distributed DES under the uncertainty of fire propagation, this section 405 outlines a MARL framework specifically designed for fire evacuation scenarios in dual-level underground railway 406 stations. The primary objective is to leverage the MARL mechanism to minimize the comprehensive risks associated 407 with the evacuation process. The problem of minimizing evacuation risk via DES guidance is formulated as a 408 cooperative Markov game, aiming to facilitate multi-agent collaboration and learn an optimal joint policy (Jiang et 409 al., 2025). Specifically, the framework optimizes the control of signage to guide evacuation by integrating fire risk 410 with passenger distribution information, while fully accounting for the specific pedestrian flow characteristics across 411 the platform and concourse levels. Within this framework, QMIX is adopted to learn the joint policy for multiple 412 agents in this complex, dynamic environment. As illustrated in Fig. 1, the guidance process involves the following 413 iterative steps: (1) Environmental data regarding fire evolution, including fire byproduct parameters and crowd 414 distribution, are acquired and mapped onto the cellular grid of the MCS network; (2) Each agent n inputs observations 415 and output a set of directional actions (corresponding to the directions defined in Section 3.1); (3) Signage agents 416 execute actions to alter guidance directions, and the state of the controlled crowd flow is updated via the MCS 417 dynamic simulation described in Section 3.2; and (4) These steps are repeated cyclically until the evacuation is 418 completed. The core of this process lies in utilizing the QMIX to continuously optimize policy parameters through 419 repeated simulation iterations. The following subsections will detail the training environment setup and the QMIX 420 network architecture. 421 3.4.1 State, observation, action, and reward design 422 To facilitate the effective training of MARL agents within complex fire environments, the abstract evacuation 423 optimization problem must be mathematically formulated. The specific definitions adopted in this study are detailed 424 below: 425 (1) State: The global state  encapsulates the comprehensive information of the subway station fire 426 evacuation system at time step . Represented by Eq. (12), it primarily comprises the total number of people 427 in the current scene  (as shown in Eq. (13)) and the risk level of each cell ci, denoted as . Specifically, 428  is derived from the fire product risk  and the congestion risk  (as shown in Eq. (15)). 429 This configuration of a global perspective ensures that the algorithm captures high-risk states across the entire 430 system. 431 .                                (12)                  432  .                                   (13) 433  .                                (14)              434 sStÃtallpti,  tÃ‚i,  tÃ‚,fireitÃ‚,congestionitÃ‚
1, |C|,,  . . .  allspttttÃ‚Ã‚=!!||2,1Call iiplttr==Ã—Ã¥,, ,fire congestionii itt tÃ‚= Ã‚ + Ã‚

14   .                    (15) 435 (2) Observation: Each agent n perceives an observation vector , representing the acquired environmental 436 information defined in Eq. (16). This includes the location risk  (where greater distance from the exit 437 implies higher risk), as well as fire risk  and congestion risk  for each cell ci. Specifically, the 438 location risk reflects the static distance cost from the current position to the safety exit, calculated via Eq. (17), 439 where  represents the maximum static field value in the scene (i.e., the distance value of the cell at the 440 furthest point from the exit). This design enables the agent to comprehend the spatial attribute that â€œdistance 441 from the exit correlates with increased riskâ€. 442 .            (16) 443  .                                (17) 444 (3) Discrete Actions: The action space A for the agents consists of a set of discrete directional guidance instructions. 445 In this study, A={a1, a2, â€¦, aN}, where the action represents a specific direction kn selected by Agent n from the 446 global set of directions K (i.e., kn âˆˆ K). The specific set of available actions for each Agent n depends on the 447 physical topology of the decision points defined in Section 3.1. It directly determines Ï€%&'âˆˆ{0,1} for c% which 448 is in the region affected by DES corresponding to Agent n. So, executing a specific action redistributes the output 449 flux of the cells in that region to the downstream neighbouring cells corresponding to the chosen direction. This 450 mechanism macroscopically reshapes the path selection probabilities of the crowd, thereby achieving physical 451 guidance of the passenger movement. 452 (4) Composite Reward: To incentivize the multi-agent system to strike an optimal balance between rapid 453 evacuation and life safety, this study designs a globally shared composite reward function ğ‘Ÿ'. This function is 454 composed of the negative weighted sum of location risk â„œ%,'cd[N+%dK, fire risk â„œ%,'0%1,, and congestion risk 455 â„œ%,'[dKe,*+%dK, as shown in Eq. (18), the detailed formulation of each individual risk provided in Eq. (19), where 456 ğœ‡- serves as the adjustment coefficient. Specifically, the location risk term aims to encourage the crowd to 457 move towards the exit (minimizing the static field value); the fire risk term penalizes exposure to hazardous 458 areas; and the congestion risk term serves to suppress excessive queuing at bottlenecks. 459     ğ‘Ÿ'=âˆ’âˆ‘â„œ'--âˆˆ{cd[N+%dK,0%1,,[dKe,*+%dK}.                          (18) 460 â„œ'-=ğœ‡-âˆ™âˆ‘â„œ%,'-|$|%g!.                                (19) 461 3.4.2 Evacuation Guidance Optimization with QMIX 462 ,,,max,max0                     riskicongestionriskiiriskiriskttttrrrrrr rrrÃ¬Â£Ã¯Ã‚=Ã­-<Â£Ã¯-Ã®not1,locationtÃ‚1,firetÃ‚1,congestiontÃ‚maxE
1, | |, 1, | |, 1, | |,, . . . ,  , , . . . ,  , , . . . ,  nl o c a t i o n l o c a t i o n f i r e f i r e c o n g e s t i o n c o n g estioncc cott t t t t t=Ã‚ Ã‚ Ã‚ Ã‚ Ã‚ Ã‚,,,maxiilocationiEEtttrÃ—Ã‚=

15  To address the non-stationarity inherent in multi-agent collaboration within subway fire evacuation scenarios, 463 this study adopts the QMIX algorithm as the core decision-making engine. QMIX is a MARL algorithm operating 464 on the centralized training with decentralized execution paradigm (Wei et al., 2025). As depicted in Fig. 3, the 465 architecture is fundamentally composed of two components: the underlying independent Agent Network and the 466 overarching Mixing Network. 467 
 468 Fig. 3 The architecture of QMIX for DES guidance. 469 For agent network, each dynamic guidance sign is modelled as an independent agent n. Specifically, at time step 470 , the agent integrates the current observation  with the hidden state from the previous moment  using a 471 Gated Recurrent Unit (GRU) to update its current memory state . This state efficiently 472 encodes the entire action-observation history , enabling the agent to infer underlying environmental dynamics 473 under partially observable conditions. Subsequently, the agent network outputs the local Q-values  for 474 all available actions based on the current history (masking unavailable actions as zero). During the actual execution 475 phase, agents adhere to a decentralized greedy policy, selecting the action with the highest local Q-value 476 autonomously without inter-agent communication. 477 To synthesize dispersed local policies into a coherent global optimal policy, QMIX introduces a centralized 478 Mixing Network at the top level to approximate the global action-value function . This network takes 479 the local values of all agents  as input and integrates them in a non-linear manner. Its core innovation 480 lies in imposing a monotonicity constraint on the network parameters, ensuring that the partial derivative of the 481 global value with respect to each local value remains non-negative (Rashid et al., 2020). To adapt to the dynamic 482 evolution of the fire, the weights of the Mixing Network are dynamically generated by Hypernetworks conditioned 483 on the global state ğ‘ +. This mechanism allows the system to adaptively recalibrate the importance weights of agents 484 in different regions in response to the global situational context. 485 The entire architecture undergoes end-to-end training, aiming to minimize the Temporal Difference error of the 486 global action-value function. During the training process, the system samples a batch of data from the experience 487 replay buffer and updates the network parameters by minimizing the loss function defined as: 488  ,                          (20) 489 Agent network 1
Agent network Nâ€¦
Mixing Network
â€¦
FCFCGRU
Action selection
Environmenttnot1ht-1(,  )nhG R U o htt t-=ns(,  )nn nQas(,  )totalQas(,  )nn nQas
()2al total1() ( ,,;)BtotbbyQ a sqs q==-Ã¥L

16   ,                        (21) 490 where B denotes the batch size of transitions randomly sampled from the experience replay buffer;  represents 491 the parameters of the current network; and  denotes the parameters of the target network; Î³ is the discount factor. 492 Through extensive iterations across parallel fire simulation scenarios, the QMIX framework facilitates the acquisition 493 of complex cooperative evacuation strategies by the DES agents, ultimately achieving the dual optimization of 494 station-wide evacuation efficiency and safety. 495 4. Numerical Test 496 4.1. Scenario Description and Parameter Setting 497 To validate the effectiveness of the proposed collaborative evacuation strategy under complex environmental 498 conditions, this study selects a underground railway station in Guiyang as the test scenario. This hub represents a 499 typical multi-level transportation complex, featuring an upper-level concourse connected to a lower-level platform 500 via staircases. This architectural configuration creates a challenging evacuation environment characterized by large 501 spatial scales, high-density crowd flows, and multi-level cascading evacuation requirements. These features make it 502 an ideal test environment for verifying agent collaboration in realistic fire scenarios. 503 The entire simulation domain is discretized into a MCS-oriented cells, as illustrated in Fig. 4(a). This multi-504 level spatial model explicitly maps the concourse (excluding unidirectional corridors and stairs to the ground), 505 staircases, platform, and carriages. By setting ğ‘™=4, the accessible area in the station comprises 244 cells with exit 506 cells located at the corners (marked in red/blue). The entire metro train, consisting of multiple cars, was discretized 507 into 24 cells. The standard cell size is set to 4 mÃ—4 m, though specific dimensions are adjusted for staircases and 508 narrow corridors to match the actual layout. In Fig. 4(a), the distinct background colors of the internal cells indicate 509 the specific sub-regions governed by 20 SES or DES. To reflect real-world physical constraints, the effective passible 510 width between adjacent cells is rigorously defined: for instance, the passage width from carriage to platform is 511 restricted to 1.4 m, while widths at fence exits and ticket gates are set to 3.25 m or 2.6 m, respectively. 512 Regarding crowd initialization, Fig. 4(b) visualizes the initial spatial distribution of passengers used in the tests. 513 To approximate realistic evacuation scenarios, passengers in the station area (excluding staircases) are generated 514 using a uniform random distribution of 0 to 10 individuals per cell, resulting in a total of 1,316 passengers. The metro 515 train, modeled as a 6-car B-type train with 24 pairs of doors (Standard Metro Trains of China - Checkerboard Hill, 516 2022), is populated with a fixed density of 38 passengers per cell, accommodating a total of 576 individuals. 517 Furthermore, the arrows in Fig. 4(b) depict the directional guidance plan of SES, which directs passengers to the 518 nearest exits based on geometric distance. 519 max ( , a , ; )total t abaot lyr Q sgs qÂ¢Â¢Â¢Â¢ -=+qq-

17   520 Fig. 4. Schematic representation of the MCS-oriented spatial discretization and guidance information. (a) Spatial discretization. Note: Internal cells are color-coded to delineate 521 the specific sub-regions controlled by different signage agents. (b) Heatmap of the initial passenger distribution and the predefined guidance directions under the SES strategy. 522 


18  To strictly simulate the dynamic evolution of fire, a high-fidelity fire model is constructed based on the actual 523 geometry of the station and train, following the systematic modeling workflow illustrated in Fig. 5. The BIM model 524 shown in Fig. 5(c) was imported into PyroSim via the IFC format, allowing the building information to be seamlessly 525 incorporated into the simulation. Monitoring points are strategically deployed at the center of each discretized cell to 526 continuously capture critical environmental parameters (see simulation outputs in Fig. 5h-j) throughout the 527 combustion process. We designed six distinct fire scenarios, encompassing both single and dual fire source 528 conditions. As shown in Fig. 4(a), the potential ignition points are located at the centers of ch (Concourse), c!i9 529 (Platform), and c":! (Metro Carriage). Each fire source is modeled as a 2 mÃ—2 m square surface with polyurethane 530 foam as the combustible material. The heat release rate follows a non-stationary ğ‘¡"-growth model, peaking at 600 531 kW. The initial environmental conditions are set to a temperature of 20Â°C with zero wind speed. 532 
 533 Fig. 5. Workflow of the fire simulation environment construction: (a-d) data acquisition from building information 534 and on-site surveys; (e-g) 3D fire dynamics modeling in PyroSim; (h-j) visualization of simulation outputs including 535 temperature, visibility, and CO concentration. 536 The key parameter settings of the evacuation environment are specified as follows. According to the SFPE 537 guidelines, the free-flow velocity in flat-floor cells ğ‘£01,,,0cN+ is set to 1.2 m/s. Based on the riserâ€“tread ratio of the 538 stairways in the scenario, the free-flow speed in stair cells ğ‘£01,,,*+N%1 is specified as 1.07 m/s. In the time-step 539 calculation (Eq. (1)), the free-flow speed ğ‘£01,, is consistently taken as 1.2 m/s, corresponding to that of flat-floor 540 cells, resulting in a MCS simulation time step of 3.3 s. The maximum speed required in Eq. (4) is set to 2.0 m/s. In 541 the fundamental diagram, also following SFPE recommendations, the critical density ğœŒ[1% for both flat-floor and 542 stair cells is set to 0.54 person/mÂ², and the maximum density ğœŒ-N] is set to 6 persons/mÂ². Accordingly, the resulting 543 k values for flat-floor cells ğœ…0cN+ and stair cells ğœ…*+N%1 are calculated as 0.22 and 0.196, respectively. In the risk 544 


19  assessment, the threshold density ğœŒ1%*^ is set to 2.5 persons/mÂ². Moreover, ğœ‡-,ğ‘šâˆˆ{ğ‘™ğ‘œğ‘ğ‘ğ‘¡ğ‘–ğ‘œğ‘›,ğ‘“ğ‘–ğ‘Ÿğ‘’,ğ‘ğ‘œğ‘›ğ‘”ğ‘’ğ‘ ğ‘¡ğ‘–ğ‘œğ‘›} 545 and ğ›½K,ğ‘›âˆˆ{ğ‘£ğ‘–ğ‘ ,ğ‘¡ğ‘’ğ‘šğ‘,ğ¶ğ‘‚,ğ‘Ÿğ‘ğ‘‘} are all set to 1. 546 4.2 Training Protocols and Implementation Details 547 In the multi-objective reward function, the weights for evacuation efficiency, fire risk, and congestion are set 548 equally. The discount factor Î³ is set to 0.99. For the QMIX architecture, the mixing network utilizes a hidden layer 549 size of 64, and the GRU hidden dimension is set to 82. To scientifically validate the superiority of the proposed 550 algorithm, the results obtained from QMIX are benchmarked against a SES strategy, which represents the most 551 common traditional guidance method in real-world facilities. 552 The training process adopts a Transfer Learning (TL) approach to enhance efficiency. Initially, the model is 553 trained on a single fire source scenario (at c!i9). The first 500 epochs serve as a pre-training phase, where the model 554 mimics the fixed directions provided by SES to acquire basic navigation logic. Subsequently, the total training 555 duration extends to 5,500 epochs, with 1,500 epochs dedicated to the TL phase for adapting to different fire scenarios. 556 Each epoch consists of one training iteration and one full episode execution to evaluate cumulative rewards. To 557 accelerate data collection, 28 episodes are run in parallel per epoch, with a maximum step limit of 150 steps per 558 episode. All agents update their actions synchronously at each step. The learning rate is set to 1Ã—10=:. The 559 exploration rate Ïµ decays linearly from 1.0 to a minimum of 0.2 at a rate of 0.0004 per step. The target Q-network is 560 updated every 100 epochs, and the experience replay buffer has a capacity of 5,000. All experiments were conducted 561 on a workstation running Ubuntu 22.04, equipped with an Intel Xeon Gold 6238R @ 2.20GHz CPU. The complete 562 training process required approximately 122 hours. 563 4.3 Convergence Analysis of Model Training 564 To demonstrate the learning efficiency and stability of the integrated simulationâ€“optimization framework, we 565 analyzed the evolution of episode rewards during the training process for the primary fire scenario (ignition at c!i9). 566 The reward curve, illustrating the cumulative reward obtained in each training epoch, is presented in Fig. 6. As shown 567 in the figure, the training process exhibits three distinct phases, reflecting the transition from heuristic imitation to 568 autonomous collaborative decision-making. 569 
 570 Fig. 6. Evolution of episode rewards during the training process for the single fire source scenario located at the 571 metro platform 572 


20  In the initial phase (approximately the first 500 epochs), the episode rewards remain constant at -10,973.5. This 573 plateau corresponds to the pre-training stage where the agents are forced to mimic the guidance logic of SES. This 574 value serves as a quantitative baseline, representing the evacuation performance (a composite of time, congestion, 575 and safety) achieved by standard fixed-direction guidance. 576 Upon transitioning to the formal reinforcement learning phase, a sharp decline in rewards is observed, with the 577 lowest value dropping to approximately -198,960. This phenomenon is attributed to the high initial exploration rate, 578 where agents actively explore the action space by taking random directions to discover potential shortcuts and avoid 579 fire hazards, initially leading to poor coordination and increased congestion. However, as the training progresses and 580 the exploration rate linearly decays, the agents gradually learn from the feedback. The reward curve demonstrates a 581 fluctuating upward trend, characterized by an oscillatory ascent. This volatility is intrinsic to multi-agent learning 582 environments, where the non-stationarity of other agents' behaviors introduces noise to the gradient updates. As the 583 number of training epochs increases, the collaborative policy stabilizes. Towards the end of the training (as seen in 584 the final segment of the data), the reward curve converges to a stable range between -9,100 and -9,500, with the 585 optimal episodes reaching approximately -9,105.  586 Importantly, the converged rewards generated by the trained QMIX agents are significantly higher (less negative) 587 than the SES baseline (-10,973.5). Specifically, the dynamic guidance strategy yields an approximate 16.5% 588 improvement in the comprehensive reward metric compared to the traditional SES. This result empirically validates 589 that the proposed algorithm has successfully learned a superior cooperative strategy that balances evacuation 590 efficiency with safety risks in the complex subway station environment. 591 
 592 Fig. 7. Convergence curves of episode rewards using TL across five distinct fire scenarios, including: (a) Single fire 593 source at the concourse (ch); (b) Single fire source inside the metro carriage (c":!); (c) Dual fire sources at the 594 concourse and platform (ch & c!i9); (d) Dual fire sources at the concourse and carriage (ch & c":!); (e) Dual fire 595 sources at the platform and carriage (c!i9 & c":!). 596 


21  To assess the robustness and scalability of the proposed framework, the policy parameters pre-trained on the 597 platform fire scenario were transferred to five other distinct hazard configurations, including both single and dual fire 598 sources. Fig. 7 illustrates the training convergence dynamics for these scenarios. Compared to the training-from-599 scratch process (Fig. 6), the TL approach demonstrates significant advantages in terms of learning efficiency and 600 policy adaptability. 601 As shown in Fig. 7(a-e), the long random exploration phase, characterized by unstable and relatively low 602 rewards (typically below -150,000 in the initial training), is effectively bypassed. Instead, the agents exhibit a jump-603 start phenomenon where the initial rewards are already comparable to or higher than the SES baseline. For instance, 604 in the single fire scenarios (a) and (b), the model rapidly converges to an optimal policy within approximately 200 605 epochs. Even in the more complex dual-fire scenarios (c-e), where the solution space is significantly constrained by 606 multiple hazards, the learning curves stabilize within 1,000 epochs. This indicates that the agents have successfully 607 retained fundamental evacuation logic (e.g., obstacle avoidance, congestion mitigation) and only require fine-tuning 608 to adapt to specific fire locations. 609 The proposed DES system consistently outperforms the traditional SES (indicated by the red dashed lines) across 610 all tested scenarios. 611 â€¢ Single Fire Source: In scenarios (a) and (b), the converged rewards of QMIX are significantly higher than the 612 baseline. Notably, in the car-fire scenario (b), the improvement is particularly pronounced, indicating that the 613 DES agents can effectively and safely guide passenger evacuation, even under more complex conditions 614 involving an additional train and increased passenger loads. 615 â€¢ Dual Fire Sources: The advantages of QMIX are even more pronounced in dual-fire scenarios (c-e). As observed 616 in Fig. 7(d) and Fig. 7(e), the SES baseline yields extremely low rewards (below -57,000) due to its inability to 617 redirect crowds when primary evacuation routes are simultaneously blocked by two fire sources. In contrast, the 618 QMIX agents learn to coordinate globally, redistributing the flow to alternative safe paths, thereby maintaining 619 the episode reward at a much safer level (approximately -40,000 to -42,000). 620 In conclusion, the experimental results confirm that the pre-trained QMIX model possesses strong generalization 621 capabilities. It can be efficiently deployed to new fire scenarios via TL, providing safer and more efficient evacuation 622 guidance than SES systems, particularly in high-risk multi-hazard situations. 623 4.4 Comparative Analysis of Evacuation Efficiency 624 To quantify the operational benefits of the proposed integrated simulationâ€“optimization framework, we recorded 625 the time-varying magnitude of the residual passenger population across all six tested scenarios. The resulting 626 evacuation curves, which map the decay of passenger counts against evacuation time, are presented in Fig. 8. These 627 curves serve as a direct indicator of the system's clearance capability, where a steeper negative slope corresponds to 628 a higher instantaneous outflow rate. 629 

22   630 Fig. 8. Temporal evolution of residual passenger counts under static and dynamic guidance strategies across six fire 631 scenarios, including: (a) Single fire source at the concourse (ğ‘h); (c) Single fire source inside the station platform 632 (c!i9); (c) Single fire source inside the metro carriage (c":!); (d) Dual fire sources at the concourse and platform (ch 633 & c!i9); (e) Dual fire sources at the concourse and carriage (ch & c":!); (f) Dual fire sources at the platform and 634 carriage (c!i9 & c":!). 635 A detailed analysis of the curves in Fig. 8 reveals critical differences in crowd dynamics under SES versus DES 636 guidance, characterized by three distinct phases: 637 â€¢ Phase I: Strategic Trade-off (Initial Stage). It is noteworthy that the performance advantage of the DES is not 638 always immediate. In the initial seconds (ğ‘¡<40s) of certain scenarios, such as Fig. 8(a) and Fig. 8(d), the 639 evacuation curves for SES (red) and DES (blue) strategies exhibit a high degree of overlap, with the SES curve 640 occasionally descending slightly faster. This transient phenomenon is attributable to the inherent logic of the two 641 strategies: SES directs passengers to the spatially nearest exits, which are initially uncongested. In contrast, the 642 DES may route passengers toward more distant but underutilized exits to prevent future bottlenecks. While this 643 strategic detour might induce a marginal initial delay, it is a necessary trade-off that optimizes the global flow 644 for subsequent phases. 645 â€¢ Phase II: Consistency of Outflow (Mid-Stage). As evacuation progresses, a distinct divergence in curve 646 morphology appears. The SES curves, particularly in multi-hazard scenarios, tend to become convex, indicating 647 a diminishing marginal rate of evacuation as primary routes become saturated. Conversely, the DES curves 648 maintain a relatively constant, steep slope (quasi-linear decay) for the majority of the duration. This implies that 649 the DES successfully maintains the stationâ€™s aggregate outflow capacity at a near-optimal level, preventing the 650 degradation of flow rates typically caused by local density accumulation. 651 


23  â€¢ Phase III: Tail Truncation (Late Stage). The most significant contrast is observed when the residual passenger 652 count drops to low levels. In scenarios like Fig. 8(f), the SES curve exhibits a pronounced prolonged evacuation 653 tail, suggesting that a small group of passengers remains trapped in hazardous zones for an extended period. The 654 dynamic strategy effectively truncates this tail, maintaining a sharp descent until the station is fully cleared. This 655 demonstrates the systemâ€™s capability to resolve bottleneck effect thereby ensuring a reliable termination of the 656 evacuation process. 657 Table 1 Comparison of Total Evacuation Time (TET) across different scenarios 658 Fire Scenario TET (under SES) TET (under DES) TET Saved Absolute Relative (%) (a) Single fire in ch 168.3 122.1 46.2 27.4% (b) Single fire in c!i9 171.6 135.3 36.3 21.2% (c) Single fire in c":! 122.1 99.0 23.1 18.9% (d) Dual fire in ch & c!i9 287.1 194.7 92.4 32.2% (e) Dual fire in ch & c":! 240.9 178.2 62.7 26.0% (f) Dual fire in c!i9 & c":! 353.1 221.1 132.0 37.4% The aggregate impact of these dynamic adjustments is summarized in Table 1, which compares the Total 659 Evacuation Time (TET) for each scenario. The quantitative data reveals a clear correlation between scenario 660 complexity and the magnitude of efficiency gains. In single fire source scenarios (Cases aâ€“c), the DES achieves a 661 robust reduction in evacuation time, ranging from approximately 18.9% to 27.4%. These results indicate that even 662 when evacuation options are relatively straightforward, dynamic load balancing can significantly expedite the process. 663 However, the advantages of the proposed framework become most prominent in dual fire source scenarios (Cases dâ€“664 f), where the evacuation environment is severely constrained. As evidenced in Table 1, the relative improvement 665 ratios escalate to 32.2% and 37.4% for the most complex cases. For instance, in the extreme scenario involving fires 666 at both the platform and the carriage (Case f), the DES reduces the total time by 132.0 seconds compared to the SES 667 baseline. These results demonstrate that the advantage of the integrated simulationâ€“optimization approach becomes 668 more significant in complex fire scenarios, as it can identify safe evacuation routes that are overlooked by SES. 669 4.5 Comparative Analysis of Fire Risk Mitigation 670 To evaluate the safety implications of the proposed guidance system, we tracked the cumulative fire risk for the 671 entire passenger population throughout the evacuation process. This metric aggregates the exposure of all passengers 672 to fire-induced conditions over time. The temporal evolution of this cumulative risk across the six tested scenarios is 673 visualized in Fig. 9. 674 

24   675 Fig. 9. Temporal evolution of cumulative fire risk experienced by passengers under static and dynamic guidance 676 strategies across six fire scenarios, including: (a) Single fire source at the concourse (ğ‘h); (c) Single fire source inside 677 the station platform (c!i9); (c) Single fire source inside the metro carriage (c":!); (d) Dual fire sources at the 678 concourse and platform (ch & c!i9); (e) Dual fire sources at the concourse and carriage (ch & c":!); (f) Dual fire 679 sources at the platform and carriage (c!i9 & c":!). 680 The comparative curves in Fig. 9 illustrate distinct differences in the accumulation patterns of fire risk under 681 static versus dynamic guidance. The curves associated with SES (red dashed lines) are characterized by a steep, quasi-682 linear gradient that persists throughout the majority of the evacuation duration. In several scenarios, particularly Fig. 683 9(d) and Fig. 9(f), the slope of the SES curve remains a high gradient even in the late stages (t > 150 s). This trend of 684 the curve indicates that the accumulation of risk does not decelerate significantly over time; rather, a substantial 685 portion of the passenger population continues to accrue exposure to fire byproducts until the end of the process. The 686 high final plateau values serve as a quantitative indicator of the total physiological load imposed on the crowd. 687 In contrast, the DES curves exhibit a markedly different trend. The curves display a much shallower initial 688 gradient, suggesting a reduced rate of risk accumulation from the onset. Furthermore, these curves tend to bend 689 towards the maximum value obviously earlier than their static counterparts. For instance, in Fig. 9(b) and Fig. 9(e), 690 the dynamic risk curves flatten out significantly while the SES curves are still rising sharply. This divergence in curve 691 shape demonstrates that under DES, the aggregate exposure of passengers to the hazard is curtailed more rapidly, 692 leading to a significantly lower total risk burden. 693 The magnitude of the disparity between the two guidance methods varies across the tested spatial configurations. 694 


25  â€¢ Single Fire Scenarios (Fig. 9aâ€“c): In scenarios with a single ignition point, a clear vertical gap between the static 695 and DES curves emerges within the first 60 seconds. In the concourse fire scenario (Fig. 9a), the SES curve 696 reaches a final value more than double that of the DES curve. This indicates that even in less geometrically 697 complex scenarios, the standard evacuation paths result in considerably higher exposure levels compared to the 698 optimized paths. 699 â€¢ Dual Fire Scenarios (Fig. 9dâ€“f): The divergence is most pronounced in multi-source fire scenarios. In the case 700 involving fires at both the Platform and the Carriage (Fig. 9f), the SES curve exhibits an almost exponential-like 701 rise in the final phase, rising sharply to a peak value of approximately 210,500. Conversely, the DES curve 702 maintains a steady, low-angle trajectory, stabilizing at approximately 67,000. The visual gap between the two 703 curves in these plots represents the massive quantity of cumulative harm that is avoided through the use of DES. 704 The final cumulative fire risk (CFR) values and the corresponding reduction percentages are detailed in Table 2. 705 The data confirms that the DES system achieves a substantial reduction in CFR, ranging from 43.7% to 68.2% across 706 the six cases. 707 Table 2. Comparison of CFR and safety improvements across scenarios 708 Fire Scenario CFR (under SES) CFR (under DES) CFR Reduction  Absolute Relative (%) (a) Single fire in ch 78542 35210 43332 55.2% (b) Single fire in c!i9 62105 33890 28215 45.4% (c) Single fire in c":! 45300 25500 19800 43.7% (d) Dual fire in ch & c!i9 158900 68200 90700 57.1% (e) Dual fire in ch & c":! 142000 51000 91000 64.1% (f) Dual fire in c!i9 & c":! 210500 67000 143500 68.2% A comparison of these figures with the time efficiency data reveals a notable numerical trend: the percentage 709 improvement in risk reduction (Table 2) is consistently higher than the percentage improvement in TET (previously 710 shown in Table 1). For example, in the dual-fire scenario (d), while the evacuation time was reduced by 32.2%, the 711 cumulative risk was reduced by 57.1%. Similarly, in scenario (e), a 26.0% improvement in time corresponds to 712 a 64.1% reduction in CFR. This data implies that the reduction in total harm is not merely a byproduct of faster 713 evacuation speeds; rather, the DES achieves a disproportionately large safety gain relative to the time saved. 714 4.6 Comparative Analysis of Congestion Relief 715 In addition to thermal hazards, high-density crowd congestion represents a critical risk factor in underground 716 evacuations, potentially leading to stampedes or crushing injuries. To quantitatively evaluate the system's 717 performance in crowd management, we tracked the cumulative congestion risk for the entire passenger population. 718 This metric is calculated by temporally aggregating the density-dependent penalties incurred across all spatial cells, 719 serving as a proxy for the total crush burden experienced by the crowd throughout the evacuation. The temporal 720 evolution of this metric for the six fire scenarios is presented in Fig. 10. 721 

26   722 Fig. 10. Temporal evolution of cumulative congestion risk experienced by passengers under static and dynamic 723 guidance strategies across six fire scenarios, including: (a) Single fire source at the concourse (ğ‘h); (c) Single fire 724 source inside the station platform (c!i9); (c) Single fire source inside the metro carriage (c":!); (d) Dual fire sources 725 at the concourse and platform (ch & c!i9); (e) Dual fire sources at the concourse and carriage (ch & c":!); (f) Dual 726 fire sources at the platform and carriage (c!i9 & c":!). 727 The comparative curves in Fig. 10 demonstrate a consistent and significant divergence between the SES and 728 DES guidance strategies, characterized by distinct trends: 729 â€¢ SES: The curves associated with SES typically exhibit a steep, constant positive gradient. This linear-like growth 730 suggests that the rate of congestion accumulation remains high and steady throughout the evacuation process. In 731 complex scenarios such as Fig. 10(d) and Fig. 10(f), the curve exhibits a rapid and sustained increase even into 732 the late stages of the simulation. This lack of deceleration in the risk accumulation implies that critical bottlenecks 733 within the station remain saturated for extended periods, continuously adding to the cumulative risk burden until 734 the last moment of clearance. 735 â€¢ DES: Conversely, the curves under DES follow a much shallower trajectory. The initial slope is visibly lower 736 than that of the static case, indicating that the immediate formation of high-density clusters is effectively 737 suppressed. More importantly, the DES curves tend to bend towards a horizontal plateau much earlier. For 738 instance, in Fig. 10(b), the DES curve stabilizes around ğ‘¡=120s, whereas the SES curve continues to climb. 739 This asymptotic behavior signifies that the duration of intense congestion is strictly limited, preventing the 740 prolonged exposure to high-density conditions that characterizes the static approach. 741 The separation between the SES and DES curves varies significantly depending on the hazard configuration, 742 reflecting the system's adaptability. 743 


27  â€¢ Single Fire Scenarios (Fig. 10aâ€“c): In single-source scenarios, a distinct gap opens up between the two curves 744 almost immediately after the onset of evacuation. In the case of the concourse fire (Fig. 10a), the final cumulative 745 value for SES is more than double that of the DES. This suggests that even when evacuation routes are relatively 746 unconstrained, the standard nearest-exit logic is more likely to lead to inefficient spatial utilization in certain 747 cases, generating unnecessary local density spikes that the DES system successfully smooths out. 748 â€¢ Dual Fire Scenarios (Fig. 10dâ€“f): The disparity becomes extreme in multi-hazard environments. In the scenario 749 involving fires at both the Platform and the Carriage (Fig. 10f), the SES curve exhibits a near-vertical takeoff, 750 reaching a final peak of approximately 39,000. In contrast, the DES curve maintains a controlled ascent, 751 culminating at a value of around 12,000. The magnitude of this gap, representing a roughly three-fold difference, 752 highlights that under SES guidance, congestion does not merely increase linearly with scenario complexity but 753 rather escalates disproportionately. The DESâ€™s ability to maintain a low CCR in such chaotic conditions 754 highlights its effectiveness in mitigating the risk of fire-induced secondary crowd accidents. 755 The final cumulative congestion risk (CCR) values and the relative improvement ratios are summarized in Table 756 3. The data confirms that the DES system achieves a significant reduction in CCR, ranging 757 from 40.9% to 68.7% across all tested cases. 758 Table 3. Comparison of CCR across fire scenarios 759 Fire Scenario CCR (under SES) CCR (under DES) CCR Reduction Absolute Relative (%) (a) Single fire in ch 2,900 1,354 1,546 53.3% (b) Single fire in c!i9 2,829 1,452 1,377 48.7% (c) Single fire in c":! 22,098 13,059 9,039 40.9% (d) Dual fire in ch & c!i9 4,560 1,827 2,733 59.9% (e) Dual fire in ch & c":! 22,335 8,300 14,035 62.8% (f) Dual fire in c!i9 & c":! 39,275 12,300 26,975 68.7% Notably, the improvement ratios in dual-fire scenarios (59.9%, 62.8%, and 68.7%) are consistently higher than 760 those in single-fire scenarios. This trend aligns with the patterns observed in Fig. 10, confirming that the marginal 761 benefit of the dynamic optimization increases as the spatial constraints become more severe. The sharp reduction in 762 CCR directly reflect a safer evacuation process where the probability of crowd-related accidents is minimized. 763 4.7 Spatiotemporal Evolution of Passenger Distribution 764 To provide a microscopic insight into the decision-making logic of the proposed framework, we visualized the 765 spatiotemporal evolution of passenger distribution under a specific scenario: a fire outbreak near the platform elevator 766 (c!i9). Fig. 11 compares the crowd dynamics under SES (at the top row) and DES (at the bottom row) at three critical 767 time steps (ğœ=10,20,30). The color gradient represents passenger volume in each cell (red indicates high 768 congestion), while the arrows in blue, red and pink respectively denote the guidance directions toward Exit 1, Exit 2, 769 and Exit 3. 770 

28   771 Fig. 11. Spatiotemporal visualization of passenger distribution and signage guidance directions at different time steps. The top row (a-c) depicts the evacuation process under 772 SES. The bottom row (d-f) illustrates the process under DS. 773 


29  Under SES guidance (Fig. 11aâ€“c), passengers rigidly follow the shortest path to the nearest exit. This lack of 774 flexibility in guidance leads to severe structural failures in the evacuation process: 775 â€¢ Bottleneck Formation at Critical Nodes: As shown in Fig. 11(a), a high-density subarea (indicated by dark red 776 cells) rapidly forms at the leftmost staircase connecting the platform to the concourse. This area is critically 777 hazardous because it is adjacent to the fire source. The presence of fire byproducts not only poses a direct health 778 threat but also degrades the effective flow capacity of the staircase, creating a negative feedback loop that 779 severely prolongs evacuation time. 780 â€¢ Cascading Congestion and Resource Imbalance: By the 20-th time step (Fig. 11b), the congestion at Exit 2 781 propagates downwards, causing a backup at the two staircases feeding into it. Consequently, the central and right 782 sections of the platform become saturated. In contrast, the staircases leading to Exit 1 remain relatively 783 underutilized (indicated by dark green cells near the Exit 1). This spatial imbalance reveals the fundamental flaw 784 of static guidance: it fails to utilize available capacity at Exit 1 to relieve the pressure on Exit 2 and the fire-785 affected leftmost stairs. 786 In contrast, the DES (Fig. 11dâ€“f) exhibits intelligent coordination capabilities, effectively redistributing the 787 crowd to optimize global efficiency and safety. 788 â€¢ Early-Stage Hazard Avoidance (ğœ=10): At the onset of evacuation (Fig. 11d), the DES agents proactively direct 789 a significant portion of passengers on the platform toward the rightmost staircases (indicated by the redirection 790 of flow arrows). This strategic maneuver successfully diverts the crowd away from the high-risk leftmost 791 staircase, preventing the formation of the dangerous bottleneck observed in the static case. 792 â€¢ Mid-Stage Load Balancing (ğœ=20): A sophisticated coordination behavior emerges at the intermediate stage 793 (Fig. 11e). Although Exit 1 has remaining capacity, the agents recognize that simply guiding most of passengers 794 there with current directional guidance might create a new bottleneck. Instead, the DES guides passengers to 795 utilize the middle staircase to access Exit 2. This decision dynamically balances the load between Exit 1 and Exit 796 2, preventing the upstream congestion at Exit 1 from propagating down to the concourse while ensuring Exit 2 797 is utilized within its safe capacity limits. This adaptability highlights the model's ability to perceive multi-level 798 congestion states. 799 â€¢ Late-Stage Clearance and Strategy Reversion (ğœ=30): In the final phase (Fig. 11f), as the crowd density drops 800 below the critical threshold, the DES automatically revert to the nearest-exit logic to expedite the clearance of 801 the few remaining passengers. Comparing Fig. 11(f) with Fig. 11(c), it is evident that the platform level is nearly 802 cleared under dynamic guidance, whereas substantial pockets of passengers remain trapped under static guidance. 803 In summary, the visualization confirms that the integrated simulationâ€“optimization framework succeeds not 804 merely by speeding up movement, but by intelligently managing the spatial distribution of the crowd. It effectively 805 relieves bottlenecks near fire sources and balances the utilization of unevenly distributed exit resources. 806 5. Summary and Discussion 807 Fire emergencies in complex underground transportation hubs, characterized by multi-level spatial 808 configurations, high-density passenger flows, and reliance on vertical transport facilities (e.g., staircases), present 809 critical challenges to evacuation safety. In such environments, the coupling of fire byproducts (toxic gas, heat) with 810 

30  crowd dynamics often creates cascading congestion, where bottlenecks at lower levels propagate rapidly to upper 811 concourses. Under these critical conditions, SES, which rigidly directs passengers to the geometrically nearest exits 812 without situational awareness, frequently fails to prevent overcrowding in hazardous zones. Conversely, DES systems, 813 empowered by real-time environmental perception and intelligent decision-making capabilities, offer a promising 814 solution to enforce adaptive guidance and optimize global evacuation outcomes. 815 To achieve effective crowd regulation in such complex scenarios, this study adopted an integrated optimization 816 framework encompassing: (1) Environment Modeling: We extended the MCS to reflect the kinematic characteristics 817 of pedestrian flows on flat ground versus staircases. By integrating the SFPE-based fundamental diagrams, the model 818 accurately captures the capacity constraints and bottleneck effects unique to vertical evacuation; (2) Hazard 819 Dynamics: The propagation of fire and its derivatives was simulated using PyroSim. Unlike static obstacle 820 assumptions, this approach dynamically maps the spatiotemporal evolution of visibility, temperature, and toxicity to 821 the walking capabilities of agents within the MCS network; (3) Coordinated Control: We utilized the QMIX 822 algorithm to coordinate multiple DES agents. This decentralized-execution, centralized-training architecture allows 823 agents to learn cooperative policies that optimize a multi-objective reward function, balancing evacuation efficiency, 824 congestion relief, and physiological safety. 825 By applying the simulation coupled optimization framework to the real-world scenario of the underground 826 railway station, we demonstrated the system's robustness across six distinct hazard configurations, ranging from 827 single ignition points to complex dual-fire events. The training phase validated the efficacy of the TL mechanism, 828 which utilized pre-trained policy parameters to achieve a â€œjump-startâ€ in performance, significantly accelerating 829 convergence for new fire scenarios. Numerical tests revealed that: (1) Superiority in complexity: Compared to the 830 SES baseline, the DES system achieved substantial improvements in all metrics, with the most significant gains 831 observed in dual-fire scenarios (e.g., reducing TET by over 37% and CFR by over 68%); (2) Strategic trade-offs: The 832 system demonstrated an intelligent safety-first logic. In high-risk situations, agents proactively directed passengers 833 along longer but safer paths to avoid fire plumes, prioritizing risk reduction over mere speed; (3) Resolution of 834 bottleneck: Examination of the evacuation curve showed that dynamic guidance effectively eliminated the prolonged 835 evacuation tail caused by static routing, resolving flow conflicts and ensuring the prompt clearance of the final group 836 of passengers. 837 Despite these advancements, we acknowledge certain limitations that delineate directions for future research. 838 First, the current framework assumes 100% compliance of passengers with DES guidance. In reality, human behavior 839 under panic is stochastic, and herding effects or mistrust of technology may influence route choice. Future models 840 should incorporate compliance probability distributions to test system robustness. Second, while the MCS captures 841 crowd density evolution in subregions, it simplifies microscopic interactions (e.g., pushing behavior at stair entries 842 or group cohesion among family members), which might affect local flow rates. Third, the reliability of the hardware 843 infrastructure is assumed to be perfect; however, in actual fires, sensors or signs might malfunction. 844 Integrating system reliability and fault tolerance into the RL state space would enhance practical applicability. Lastly, 845 the current study focuses on a specific underground railway station; testing the scalability of the algorithm on city-846 scale networks with multimodal transport interactions remains a grand challenge for the next stage of research. 847   848 

31  References 849 Asano, M., Sumalee, A., Kuwahara, M., & Tanaka, S. (2007). Dynamic cell transmission-based pedestrian model 850 with multidirectional flows and strategic route choices. Transportation Research Record, 2039(1), 42â€“851 49. https://doi.org/10.3141/2039-05 852 Bai, J., Lv, X., Nie, L., & Fang, M. (2025). Evacuation route determination in indoor architectural environments 853 based on dynamic fire risk assessment. Buildings, 15(10), 1715. https://doi.org/10.3390/buildings15101715 854 Batty, M. (2001). Agent-based pedestrian modeling. Environment and Planning B: Planning and Design, 28(3), 321â€“855 326. https://doi.org/10.1068/b2803ed 856 Blue, V. J., & Adler, J. L. (1998). Emergent fundamental pedestrian flows from cellular automata 857 microsimulation. Transportation Research Record, 1644, 29â€“36. https://doi.org/10.3141/1644-04 858 BNO News. (2025, February 25). Subway fire in Upper Manhattan causes heavy smoke, injures 859 18. https://bnonews.com/index.php/2025/02/subway-fire-in-upper-manhattan-causes-heavy-smoke-injures-18/ 860 Cao, R. F., Lee, E. W. M., Xie, W., Gao, D. L., Chen, Q., Yuen, A. C. Y., Yeoh, G. H., & Yuen, R. K. K. (2023). 861 Development of an agent-based indoor evacuation model for local fire risks analysis. Journal of Safety Science 862 and Resilience, 4(1), 75â€“92. https://doi.org/10.1016/j.jnlssr.2022.09.006 863 Checkerboard Hill. (n.d.). Standard metro trains of China. Retrieved December 22, 2025, 864 from https://www.checkerboardhill.com/2022/04/metro-train-carbody-standards-of-china/ 865 Chen, J., Liu, C., Meng, Y., & Zhong, M. (2021). Multi-dimensional evacuation risk evaluation in standard subway 866 station. Safety Science, 142, 105392. https://doi.org/10.1016/j.ssci.2021.105392 867 Chen, X., Treiber, M., Kanagaraj, V., & Li, H. (2018). Social force models for pedestrian trafficâ€“state of the 868 art. Transport Reviews, 38(5), 625â€“653. https://doi.org/10.1080/01441647.2017.1396265 869 Cho, J., Lee, G., & Lee, S. (2015). An automated direction setting algorithm for a smart exit sign. Automation in 870 Construction, 59, 139â€“148. https://doi.org/10.1016/j.autcon.2015.05.004 871 Chow, W. K., & Ng, C. M. Y. (2008). Waiting time in emergency evacuation of crowded public transport 872 terminals. Safety Science, 46(5), 844â€“857. https://doi.org/10.1016/j.ssci.2007.01.015 873 Ding, Z., Sun, Z., & Xu, X. (2025). An automatic flood escape route identification method for existing underground 874 spaces: From the perspective of multi-objective trade-offs. Computers & Industrial Engineering, 204, 875 111082. https://doi.org/10.1016/j.cie.2025.111082 876 Ding, Z., Xu, S., Xie, X., Zheng, K., Wang, D., Fan, J., Li, H., & Liao, L. (2024). A building information modeling-877 based fire emergency evacuation simulation system for large infrastructures. Reliability Engineering & System 878 Safety, 244, 109917. https://doi.org/10.1016/j.ress.2023.109917 879 Fitkau, I., & Hartmann, T. (2025). Applying multi-agent reinforcement learning for escape path planning in a fire 880 evacuation environment. In EG-ICE 2025. https://doi.org/10.17868/strath.00093292 881 Fu, M., & Liu, R. (2020). BIM-based automated determination of exit sign direction for intelligent building sign 882 systems. Automation in Construction, 120, 103353. https://doi.org/10.1016/j.autcon.2020.103353 883 Guo, K., & Zhang, L. (2022). Adaptive multi-objective optimization for emergency evacuation at metro 884 stations. Reliability Engineering & System Safety, 219, 108210. https://doi.org/10.1016/j.ress.2021.108210 885 

32  Guo, K., Zhang, L., & Wu, M. (2023). Simulation-based multi-objective optimization towards proactive evacuation 886 planning at metro stations. Engineering Applications of Artificial Intelligence, 120, 887 105858. https://doi.org/10.1016/j.engappai.2023.105858 888 Haghani, M., & Sarvi, M. (2019). Imitative (herd) behaviour in direction decision-making hinders efficiency of crowd 889 evacuation processes. Safety Science, 114, 49â€“60. https://doi.org/10.1016/j.ssci.2018.12.026 890 Helbing, D., & MolnÃ¡r, P. (1995). Social force model for pedestrian dynamics. Physical Review E, 51(5), 891 4282. https://doi.org/10.1103/PhysRevE.51.4282 892 Hsu, C. H. (2024). Simulation of emergency evacuation with crowd-gathering risk and evaluation methods: A case 893 study of the mass rapid transit system in Taipei. Transportation Planning and Technology, 47(4), 514â€“894 539. https://doi.org/10.1080/03081060.2023.2293056 895 Huang, D., Lo, S., Chen, J., Fu, Z., Zheng, Y., Luo, L., Zhuang, Y., Cheng, H., & Yang, L. (2019). Mapping fire risk 896 of passenger-carried fire load in metro system via floor field cellular automaton. Automation in Construction, 897 100, 61â€“72. https://doi.org/10.1016/j.autcon.2018.12.021 898 Huang, S., Lou, X., Hu, M., & Liao, W. (2024). Research on fire evacuation strategies for ultra-deep metro hubs. 899 In Mechanisms and Machine Science (Vol. 168, pp. 972â€“982). https://doi.org/10.1007/978-3-031-68775-4_74 900 Huang, Z., Sheng, Z., Ma, C., & Chen, S. (2024). Human as AI mentor: Enhanced human-in-the-loop reinforcement 901 learning for safe and efficient autonomous driving. Communications in Transportation Research, 4, 902 100127. https://doi.org/10.1016/j.commtr.2024.100127 903 Hughes, R. L. (2002). A continuum theory for the flow of pedestrians. Transportation Research Part B: 904 Methodological, 36(6), 507â€“535. https://doi.org/10.1016/S0191-2615(01)00015-7 905 Hurley, M. J., Gottuk, D., Hall, J. R., Harada, K., Kuligowski, E., Puchovsky, M., Torero, J., Watts, J. M., & 906 Wieczorek, C. (Eds.). (2016). SFPE handbook of fire protection engineering (5th ed.). 907 Springer. https://doi.org/10.1007/978-1-4939-2565-0 908 Jiang, K. Y., Chiu, W. Y., & Tsai, Y. P. (2025). Profit maximization for electric vehicle charging stations using 909 multiagent reinforcement learning. Sustainable Energy, Grids and Networks, 44, 910 102009. https://doi.org/10.1016/j.segan.2025.102009 911 Jin, B., Wang, J., Wang, Y., Gu, Y., & Wang, Z. (2020). Temporal and spatial distribution of pedestrians in subway 912 evacuation under node failure by multi-hazards. Safety Science, 127, 913 104695. https://doi.org/10.1016/j.ssci.2020.104695 914 Ju, Y. (2021). A fire simulation method of urban light rail station hall based on building information model and 915 PyroSim software. Journal of Physics: Conference Series, 1903(1), 012065. https://doi.org/10.1088/1742-916 6596/1903/1/012065 917 Kang, J., Jeong, I. J., & Kwun, J. B. (2015). Optimal facilityâ€“final exit assignment algorithm for building complex 918 evacuation. Computers & Industrial Engineering, 85, 169â€“176. https://doi.org/10.1016/j.cie.2015.03.012 919 Kasereka, S. K., Kabwe, O. M., Kinyanta, M. W. K., Kasongo, A. L., Ilunga, G. W. K., Muhambya, K., Tashev, T., 920 & Kyamakya, K. (2025). Enhancing building safety: A brief review of agent-based modeling for fire evacuation 921 simulation. Procedia Computer Science, 257, 668â€“675. https://doi.org/10.1016/j.procs.2025.03.086 922 

33  Kim, Y. J., Kim, H., Ha, B., & Kim, W. T. (2024). Advanced fire emergency management based on potential fire 923 risk assessment with informative digital twins. Automation in Construction, 167, 924 105722. https://doi.org/10.1016/j.autcon.2024.105722 925 Li, D. W., Liu, F. L., Wang, Y. X., & Zhou, W. T. (2014). Research on simulation of evacuation in the deep buried 926 station of urban rail transit. Applied Mechanics and Materials, 505â€“506, 712â€“927 718. https://doi.org/10.4028/www.scientific.net/amm.505-506.712 928 Li, M., Xu, C., Xu, Y., Ma, L., & Wei, Y. (2022). Dynamic sign guidance optimization for crowd evacuation 929 considering flow equilibrium. Journal of Advanced Transportation, 2022, 930 2555350. https://doi.org/10.1155/2022/2555350 931 Li, N., & Guo, R. Y. (2021). Human behavior during emergency evacuation: Cell transmission model. IEEE Access, 932 9, 42463â€“42482. https://doi.org/10.1109/ACCESS.2021.3059326 933 Li, X. J., Chen, W. B., Chen, R. X., Chang, C. T., & Chen, S. H. (2023). Evacuation-path-selection model of real-934 time fire diffusion in urban underground complexes. Computers & Industrial Engineering, 177, 935 109014. https://doi.org/10.1016/j.cie.2023.109014 936 Lin, J., Zhu, R., Li, N., & Becerik-Gerber, B. (2020). Do people follow the crowd in building emergency evacuation? 937 A cross-cultural immersive virtual reality-based study. Advanced Engineering Informatics, 43, 938 101040. https://doi.org/10.1016/j.aei.2020.101040 939 Lin, W., Hu, X., & Wang, J. (2023). Multi-level objective control of AVs at a saturated signalized intersection with 940 multi-agent deep reinforcement learning approach. Journal of Intelligent and Connected Vehicles, 6(4), 250â€“941 263. https://doi.org/10.26599/JICV.2023.9210021 942 Liu, S., Lo, S., Ma, J., & Wang, W. (2014). An agent-based microscopic pedestrian flow simulation model for 943 pedestrian traffic problems. IEEE Transactions on Intelligent Transportation Systems, 15(3), 992â€“944 1001. https://doi.org/10.1109/TITS.2013.2292526 945 Liu, Z., & Zou, R. (2024). Dynamic evacuation path planning for subway station fire based on IACO. Journal of 946 Building Engineering, 86, 108828. https://doi.org/10.1016/j.jobe.2024.108828 947 Lu, T., Zhang, Y., Xie, W., & Huang, X. (2026). Human-AI interactive framework for smart evacuation safety 948 analysis in large infrastructures. Reliability Engineering & System Safety, 266, 949 111695. https://doi.org/10.1016/j.ress.2025.111695 950 Lu, Y., Deng, Y., & Sun, S. (2024). Design for safety in metro station evacuation: A study of fire emergency 951 evacuation behavior and simulation. Engineering, Construction and Architectural Management, 31(9), 3479â€“952 3507. https://doi.org/10.1108/ECAM-12-2022-1169 953 Novozhilov, V. (2001). Computational fluid dynamics modeling of compartment fires. Progress in Energy and 954 Combustion Science, 27(6), 611â€“666. https://doi.org/10.1016/S0360-1285(01)00005-3 955 Padovano, A., Longo, F., Manca, L., & Grugni, R. (2024). Improving safety management in railway stations through 956 a simulation-based digital twin approach. Computers & Industrial Engineering, 187, 957 109839. https://doi.org/10.1016/j.cie.2023.109839 958 

34  Peacock, R. D., Forney, G. P., Reneke, P. A., Jones, W. W., & Portier, R. W. (1993). CFAST: The consolidated model 959 of fire growth and smoke transport (NIST Technical Note 1299). National Institute of Standards and 960 Technology. https://doi.org/10.6028/NIST.TN.1299 961 Rashid, T., Samvelyan, M., Schroeder De Witt, C., Farquhar, G., Foerster, J., & Whiteson, S. (2020). Monotonic 962 value function factorisation for deep multi-agent reinforcement learning. Journal of Machine Learning Research, 963 21(1), 1â€“51. http://jmlr.org/papers/v21/20-081.html 964 Sharma, J., Andersen, P. A., Granmo, O. C., & Goodwin, M. (2021). Deep Q-learning with Q-matrix transfer learning 965 for novel fire evacuation environment. IEEE Transactions on Systems, Man, and Cybernetics: Systems, 51(12), 966 7363â€“7381. https://doi.org/10.1109/TSMC.2020.2967936 967 Shen, Y., Ma, J., Fang, H., Lo, S. M., & Shi, C. (2022). Deep reinforcement learning based train door adaptive control 968 in metro tunnel evacuation optimization. Tunnelling and Underground Space Technology, 128, 969 104636. https://doi.org/10.1016/j.tust.2022.104636 970 Sheng, Z., Huang, Z., & Chen, S. (2024). Traffic expertise meets residual RL: Knowledge-informed model-based 971 residual reinforcement learning for CAV trajectory control. Communications in Transportation Research, 4, 972 100142. https://doi.org/10.1016/j.commtr.2024.100142 973 SoraNews24. (2025, July 21). Mobile battery fire breaks out on Tokyoâ€™s main commuter 974 line. https://soranews24.com/2025/07/21/mobile-battery-fire-breaks-out-on-tokyos-main-commuter-line/ 975 The Chosun Daily. (2025, May 31). Man sets fire on Seoul subway train, injuring 976 21. https://www.chosun.com/english/national-en/2025/05/31/2ITSLJL3CBE73NGZ3XOUF4QYFE/ 977 The Ministry of Public Security of the Peopleâ€™s Republic of China. (2006). Standard for fire safety management of 978 assembly occupancies (GA 654-2006). Standards of 979 China. https://www.standardsofchina.com/standard/GA654-2006 980 Tong, R., Wang, B., Li, J., Tang, S., Zhang, B., & Tan, Z. (2015). A risk-based approach for crowd evacuation 981 performance evaluation under metro fire. Georisk, 9(2), 75â€“982 95. https://doi.org/10.1080/17499518.2015.1030680 983 Twarogowska, M., Goatin, P., & Duvigneau, R. (2014). Comparative study of macroscopic pedestrian 984 models. Transportation Research Procedia, 2, 477â€“485. https://doi.org/10.1016/j.trpro.2014.09.063 985 Wang, J., Zuo, C., Duan, Q., Ma, Z., & Gong, S. (2025). Smoke flow and evacuation safety in the event of fire in an 986 underground rail transit transfer station. Buildings, 15(17), 3008. https://doi.org/10.3390/buildings15173008 987 Wang, Q., Liu, H., Gao, K., & Zhang, L. (2019). Improved multi-agent reinforcement learning for path planning-988 based crowd simulation. IEEE Access, 7, 73841â€“73855. https://doi.org/10.1109/ACCESS.2019.2920913 989 Wei, D., Yi, P., Lei, J., & Zhu, X. (2025). Multi-agent deep reinforcement learning for distributed and autonomous 990 platoon coordination via speed-regulation over large-scale transportation networks. IEEE Transactions on 991 Intelligent Transportation Systems, 26(11), 20054â€“20070. https://doi.org/10.1109/TITS.2025.3590086 992 Wu, X., Zhang, X., Huang, X., Xiao, F., & Usmani, A. (2021). A real-time forecast of tunnel fire based on numerical 993 database and artificial intelligence. Building Simulation, 15(4), 511â€“524. https://doi.org/10.1007/s12273-021-994 0775-x 995 

35  Xie, C. Z. T., Chen, Q., Zhu, B., Lee, E. W. M., Tang, T. Q., Yin, X., Yuan, Z., & Zhang, B. (2025). Coordinating 996 dynamic signage for evacuation guidance: A multi-agent reinforcement learning approach integrating 997 mesoscopic crowd modeling and fire propagation. Chaos, Solitons & Fractals, 194, 998 116246. https://doi.org/10.1016/j.chaos.2025.116246 999 Xie, J., Chen, K., Kwan, T. H., & Yao, Q. (2021). Numerical simulation of the fire emergency evacuation for a metro 1000 platform accident. SIMULATION, 97(1), 19â€“32. https://doi.org/10.1177/0037549720961433 1001 Ye, C., Liu, Y., & Sun, C. (2020). Risk assessment of pedestrian evacuation under the influence of fire 1002 products. Discrete Dynamics in Nature and Society, 2020, 9540942. https://doi.org/10.1155/2020/9540942 1003 Zhang, B., Lo, J. T. Y., Fang, H., Xie, C., Tang, T., & Lo, S. (2024a). Coupled simulation-optimization model for 1004 pedestrian evacuation guidance planning. Simulation Modelling Practice and Theory, 134, 1005 102922. https://doi.org/10.1016/j.simpat.2024.102922 1006 Zhang, B., Lo, J. T. Y., Fang, H., Xie, C., Tang, T., & Lo, S. (2024b). Directed rooted forest based direction setting 1007 method: A step toward automated dynamic exit signs. Journal of Building Engineering, 85, 1008 108504. https://doi.org/10.1016/j.jobe.2024.108504 1009 Zhang, L., Liu, M., Wu, X., & AbouRizk, S. M. (2016). Simulation-based route planning for pedestrian evacuation 1010 in metro stations: A case study. Automation in Construction, 71, 430â€“1011 442. https://doi.org/10.1016/j.autcon.2016.08.031 1012 Zhang, L., Wu, X., Liu, M., Liu, W., & Ashuri, B. (2019). Discovering worst fire scenarios in subway stations: A 1013 simulation approach. Automation in Construction, 99, 183â€“196. https://doi.org/10.1016/j.autcon.2018.12.007 1014 Zhang, N., Liang, Y., Zhou, C., Niu, M., & Wan, F. (2022). Study on fire smoke distribution and safety evacuation 1015 of subway station based on BIM. Applied Sciences, 12(24), 12808. https://doi.org/10.3390/app122412808 1016 Zhang, Y., Li, W., Rui, Y., Wang, S., Zhu, H., & Yan, Z. (2022). A modified cellular automaton model of pedestrian 1017 evacuation in a tunnel fire. Tunnelling and Underground Space Technology, 130, 1018 104673. https://doi.org/10.1016/j.tust.2022.104673 1019 Zhang, Y. Q., Wang, J. H., Wang, Y., Jia, Z. C., Sun, Q., Pei, Q. Y., & Wu, D. (2024). Intelligent planning of fire 1020 evacuation routes in buildings based on improved adaptive ant colony algorithm. Computers & Industrial 1021 Engineering, 194, 110335. https://doi.org/10.1016/j.cie.2024.110335 1022 Zhang, Y., Ding, Y., Zhang, X., & Huang, X. (2025a). Multi-scale spatial-temporal principles of global evacuation 1023 safety based on Pareto frontiers: A demonstration in tunnel. Tunnelling and Underground Space Technology, 1024 166, 106950. https://doi.org/10.1016/j.tust.2025.106950 1025 Zhang, Y., Li, W., Rui, Y., & Yan, Z. (2025b). Full-scale experimental study and formular movement modelling for 1026 firefighting routes via vertical shafts in natural-ventilated tunnels. Tunnelling and Underground Space 1027 Technology, 165, 106837. https://doi.org/10.1016/j.tust.2025.106837 1028 Zhao, H., Liang, Z., Ma, T., Shi, X., Kapadia, M., Thrash, T., Hoelscher, C., Jia, J., Liu, B., & Cao, J. (2024). 1029 Adversarial reinforcement learning for enhanced decision-making of evacuation guidance robots in intelligent 1030 fire scenarios. IEEE Transactions on Computational Social Systems. Advance online 1031 publication. https://doi.org/10.1109/TCSS.2024.3502420 1032 

36  Zhao, H., Schwabe, A., SchlÃ¤fli, F., Thrash, T., Aguilar, L., Dubey, R. K., Karjalainen, J., HÃ¶lscher, C., Helbing, D., 1033 & Schinazi, V. R. (2022). Fire evacuation supported by centralized and decentralized visual guidance 1034 systems. Safety Science, 145, 105451. https://doi.org/10.1016/j.ssci.2021.105451 1035 Zhao, X., Shu, Z., & Pei, X. (2023). Research and perspectives on fire-fighting systems in tunnels under strong piston 1036 wind action. Buildings, 13(2), 435. https://doi.org/10.3390/buildings13020435 1037 Zhong, M., Shi, C., Tu, X., Fu, T., & He, L. (2008). Study of the human evacuation simulation of metro fire safety 1038 analysis in China. Journal of Loss Prevention in the Process Industries, 21(3), 287â€“1039 298. https://doi.org/10.1016/j.jlp.2007.08.001 1040 Zhou, M., Dong, H., Ioannou, P. A., Zhao, Y., & Wang, F.-Y. (2019). Guided crowd evacuation: Approaches and 1041 challenges. IEEE/CAA Journal of Automatica Sinica, 6(1), 108â€“1042 120. https://doi.org/10.1109/JAS.2019.1911672 1043 